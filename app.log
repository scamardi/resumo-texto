2024-09-30 23:11:15,483 - app.logging.logging_interceptor - INFO - Requisição e resposta
2024-09-30 23:20:52,011 - app.logging.logging_interceptor - INFO - 
2024-10-01 02:55:55,325 - app.logging.logging_interceptor - INFO - 
2024-10-01 02:56:03,120 - app.exception.handler_excecao - ERROR - {'correlation_id': '12345', 'error': {'type': 'ExceptionGroup', 'message': 'unhandled errors in a TaskGroup (1 sub-exception)', 'traceback': 'Traceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 108, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/app/app/logging/logging_interceptor.py", line 17, in log_request\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 84, in call_next\n    raise app_exc\n  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File "/usr/local/lib/python3.11/site-packages/prometheus_fastapi_instrumentator/middleware.py", line 155, in __call__\n    raise exc\n  File "/usr/local/lib/python3.11/site-packages/prometheus_fastapi_instrumentator/middleware.py", line 153, in __call__\n    await self.app(scope, receive, send_wrapper)\n  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__\n    raise exc\n  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__\n    await self.app(scope, receive, sender)\n  File "/usr/local/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 21, in __call__\n    raise e\n  File "/usr/local/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__\n    await self.app(scope, receive, send)\n  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__\n    await route.handle(scope, receive, send)\n  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle\n    await self.app(scope, receive, send)\n  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 66, in app\n    response = await func(request)\n               ^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 237, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 163, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/app/app/router/resumo_router.py", line 13, in obter_resumo\n    return resumo_service.obter_resumo_existente(url)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/app/app/service/resumo_service.py", line 56, in obter_resumo_existente\n    resumo = self.resumo_repository.buscar_por_url(url)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/app/app/dataprovider/database/repository/resumo_repository.py", line 20, in buscar_por_url\n    return self.db.query(Resumo).filter(Resumo.url == url).first()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2743, in first\n    return self.limit(1)._iter().first()  # type: ignore\n           ^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2842, in _iter\n    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(\n                                                  ^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2262, in execute\n    return self._execute_internal(\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2134, in _execute_internal\n    conn = self._connection_for_bind(bind)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2001, in _connection_for_bind\n    return trans._connection_for_bind(engine, execution_options)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "<string>", line 2, in _connection_for_bind\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1126, in _connection_for_bind\n    conn = bind.connect()\n           ^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3264, in connect\n    return self._connection_cls(self)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 147, in __init__\n    Connection._handle_dbapi_exception_noconnection(\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2426, in _handle_dbapi_exception_noconnection\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 145, in __init__\n    self._dbapi_connection = engine.raw_connection()\n                             ^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3288, in raw_connection\n    return self.pool.connect()\n           ^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 452, in connect\n    return _ConnectionFairy._checkout(self)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 1267, in _checkout\n    fairy = _ConnectionRecord.checkout(pool)\n            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 716, in checkout\n    rec = pool._do_get()\n          ^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get\n    with util.safe_reraise():\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 167, in _do_get\n    return self._create_connection()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 393, in _create_connection\n    return _ConnectionRecord(self)\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 678, in __init__\n    self.__connect()\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 902, in __connect\n    with util.safe_reraise():\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 898, in __connect\n    self.dbapi_connection = connection = pool._invoke_creator(self)\n                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/create.py", line 637, in connect\n    return dialect.connect(*cargs, **cparams)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 615, in connect\n    return self.loaded_dbapi.connect(*cargs, **cparams)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/psycopg2/__init__.py", line 122, in connect\n    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nsqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: Connection refused\n\tIs the server running on that host and accepting TCP/IP connections?\nconnection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused\n\tIs the server running on that host and accepting TCP/IP connections?\n\n(Background on this error at: https://sqlalche.me/e/20/e3q8)\n\nDuring handling of the above exception, another exception occurred:\n\n  + Exception Group Traceback (most recent call last):\n  |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__\n  |     await self.app(scope, receive, _send)\n  |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 106, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |   File "/usr/local/lib/python3.11/site-packages/anyio/_backends/_asyncio.py", line 736, in __aexit__\n  |     raise BaseExceptionGroup(\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 145, in __init__\n    |     self._dbapi_connection = engine.raw_connection()\n    |                              ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3288, in raw_connection\n    |     return self.pool.connect()\n    |            ^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 452, in connect\n    |     return _ConnectionFairy._checkout(self)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 1267, in _checkout\n    |     fairy = _ConnectionRecord.checkout(pool)\n    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 716, in checkout\n    |     rec = pool._do_get()\n    |           ^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get\n    |     with util.safe_reraise():\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__\n    |     raise exc_value.with_traceback(exc_tb)\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 167, in _do_get\n    |     return self._create_connection()\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 393, in _create_connection\n    |     return _ConnectionRecord(self)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 678, in __init__\n    |     self.__connect()\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 902, in __connect\n    |     with util.safe_reraise():\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__\n    |     raise exc_value.with_traceback(exc_tb)\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 898, in __connect\n    |     self.dbapi_connection = connection = pool._invoke_creator(self)\n    |                                          ^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/create.py", line 637, in connect\n    |     return dialect.connect(*cargs, **cparams)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 615, in connect\n    |     return self.loaded_dbapi.connect(*cargs, **cparams)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/psycopg2/__init__.py", line 122, in connect\n    |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    | psycopg2.OperationalError: connection to server at "localhost" (::1), port 5432 failed: Connection refused\n    | \tIs the server running on that host and accepting TCP/IP connections?\n    | connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused\n    | \tIs the server running on that host and accepting TCP/IP connections?\n    | \n    | \n    | The above exception was the direct cause of the following exception:\n    | \n    | Traceback (most recent call last):\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 108, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/app/app/logging/logging_interceptor.py", line 17, in log_request\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 84, in call_next\n    |     raise app_exc\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 70, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File "/usr/local/lib/python3.11/site-packages/prometheus_fastapi_instrumentator/middleware.py", line 155, in __call__\n    |     raise exc\n    |   File "/usr/local/lib/python3.11/site-packages/prometheus_fastapi_instrumentator/middleware.py", line 153, in __call__\n    |     await self.app(scope, receive, send_wrapper)\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__\n    |     raise exc\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__\n    |     await self.app(scope, receive, sender)\n    |   File "/usr/local/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 21, in __call__\n    |     raise e\n    |   File "/usr/local/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__\n    |     await route.handle(scope, receive, send)\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle\n    |     await self.app(scope, receive, send)\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 66, in app\n    |     response = await func(request)\n    |                ^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 237, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 163, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/app/app/router/resumo_router.py", line 13, in obter_resumo\n    |     return resumo_service.obter_resumo_existente(url)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/app/app/service/resumo_service.py", line 56, in obter_resumo_existente\n    |     resumo = self.resumo_repository.buscar_por_url(url)\n    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/app/app/dataprovider/database/repository/resumo_repository.py", line 20, in buscar_por_url\n    |     return self.db.query(Resumo).filter(Resumo.url == url).first()\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2743, in first\n    |     return self.limit(1)._iter().first()  # type: ignore\n    |            ^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2842, in _iter\n    |     result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(\n    |                                                   ^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2262, in execute\n    |     return self._execute_internal(\n    |            ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2134, in _execute_internal\n    |     conn = self._connection_for_bind(bind)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2001, in _connection_for_bind\n    |     return trans._connection_for_bind(engine, execution_options)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "<string>", line 2, in _connection_for_bind\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go\n    |     ret_value = fn(self, *arg, **kw)\n    |                 ^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1126, in _connection_for_bind\n    |     conn = bind.connect()\n    |            ^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3264, in connect\n    |     return self._connection_cls(self)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 147, in __init__\n    |     Connection._handle_dbapi_exception_noconnection(\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2426, in _handle_dbapi_exception_noconnection\n    |     raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 145, in __init__\n    |     self._dbapi_connection = engine.raw_connection()\n    |                              ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3288, in raw_connection\n    |     return self.pool.connect()\n    |            ^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 452, in connect\n    |     return _ConnectionFairy._checkout(self)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 1267, in _checkout\n    |     fairy = _ConnectionRecord.checkout(pool)\n    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 716, in checkout\n    |     rec = pool._do_get()\n    |           ^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get\n    |     with util.safe_reraise():\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__\n    |     raise exc_value.with_traceback(exc_tb)\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 167, in _do_get\n    |     return self._create_connection()\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 393, in _create_connection\n    |     return _ConnectionRecord(self)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 678, in __init__\n    |     self.__connect()\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 902, in __connect\n    |     with util.safe_reraise():\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__\n    |     raise exc_value.with_traceback(exc_tb)\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 898, in __connect\n    |     self.dbapi_connection = connection = pool._invoke_creator(self)\n    |                                          ^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/create.py", line 637, in connect\n    |     return dialect.connect(*cargs, **cparams)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 615, in connect\n    |     return self.loaded_dbapi.connect(*cargs, **cparams)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/psycopg2/__init__.py", line 122, in connect\n    |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    | sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: Connection refused\n    | \tIs the server running on that host and accepting TCP/IP connections?\n    | connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused\n    | \tIs the server running on that host and accepting TCP/IP connections?\n    | \n    | (Background on this error at: https://sqlalche.me/e/20/e3q8)\n    +------------------------------------\n'}, 'request': {'method': 'GET', 'url': 'http://localhost:8080/resumos?url=https%3A%2F%2Fwww.wikipedia.org%2Fteste', 'headers': {'host': 'localhost:8080', 'user-agent': 'insomnia/10.0.0', 'correlationid': '12345', 'accept': '*/*'}}}
2024-10-01 02:56:04,180 - app.exception.handler_excecao - ERROR - {'correlation_id': '12345', 'error': {'type': 'ExceptionGroup', 'message': 'unhandled errors in a TaskGroup (1 sub-exception)', 'traceback': 'Traceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 108, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/app/app/logging/logging_interceptor.py", line 17, in log_request\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 84, in call_next\n    raise app_exc\n  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File "/usr/local/lib/python3.11/site-packages/prometheus_fastapi_instrumentator/middleware.py", line 155, in __call__\n    raise exc\n  File "/usr/local/lib/python3.11/site-packages/prometheus_fastapi_instrumentator/middleware.py", line 153, in __call__\n    await self.app(scope, receive, send_wrapper)\n  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__\n    raise exc\n  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__\n    await self.app(scope, receive, sender)\n  File "/usr/local/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 21, in __call__\n    raise e\n  File "/usr/local/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__\n    await self.app(scope, receive, send)\n  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__\n    await route.handle(scope, receive, send)\n  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle\n    await self.app(scope, receive, send)\n  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 66, in app\n    response = await func(request)\n               ^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 237, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 163, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/app/app/router/resumo_router.py", line 13, in obter_resumo\n    return resumo_service.obter_resumo_existente(url)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/app/app/service/resumo_service.py", line 56, in obter_resumo_existente\n    resumo = self.resumo_repository.buscar_por_url(url)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/app/app/dataprovider/database/repository/resumo_repository.py", line 20, in buscar_por_url\n    return self.db.query(Resumo).filter(Resumo.url == url).first()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2743, in first\n    return self.limit(1)._iter().first()  # type: ignore\n           ^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2842, in _iter\n    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(\n                                                  ^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2262, in execute\n    return self._execute_internal(\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2134, in _execute_internal\n    conn = self._connection_for_bind(bind)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2001, in _connection_for_bind\n    return trans._connection_for_bind(engine, execution_options)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "<string>", line 2, in _connection_for_bind\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1126, in _connection_for_bind\n    conn = bind.connect()\n           ^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3264, in connect\n    return self._connection_cls(self)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 147, in __init__\n    Connection._handle_dbapi_exception_noconnection(\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2426, in _handle_dbapi_exception_noconnection\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 145, in __init__\n    self._dbapi_connection = engine.raw_connection()\n                             ^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3288, in raw_connection\n    return self.pool.connect()\n           ^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 452, in connect\n    return _ConnectionFairy._checkout(self)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 1267, in _checkout\n    fairy = _ConnectionRecord.checkout(pool)\n            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 716, in checkout\n    rec = pool._do_get()\n          ^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get\n    with util.safe_reraise():\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 167, in _do_get\n    return self._create_connection()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 393, in _create_connection\n    return _ConnectionRecord(self)\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 678, in __init__\n    self.__connect()\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 902, in __connect\n    with util.safe_reraise():\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 898, in __connect\n    self.dbapi_connection = connection = pool._invoke_creator(self)\n                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/create.py", line 637, in connect\n    return dialect.connect(*cargs, **cparams)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 615, in connect\n    return self.loaded_dbapi.connect(*cargs, **cparams)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/psycopg2/__init__.py", line 122, in connect\n    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nsqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: Connection refused\n\tIs the server running on that host and accepting TCP/IP connections?\nconnection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused\n\tIs the server running on that host and accepting TCP/IP connections?\n\n(Background on this error at: https://sqlalche.me/e/20/e3q8)\n\nDuring handling of the above exception, another exception occurred:\n\n  + Exception Group Traceback (most recent call last):\n  |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__\n  |     await self.app(scope, receive, _send)\n  |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 106, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |   File "/usr/local/lib/python3.11/site-packages/anyio/_backends/_asyncio.py", line 736, in __aexit__\n  |     raise BaseExceptionGroup(\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 145, in __init__\n    |     self._dbapi_connection = engine.raw_connection()\n    |                              ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3288, in raw_connection\n    |     return self.pool.connect()\n    |            ^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 452, in connect\n    |     return _ConnectionFairy._checkout(self)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 1267, in _checkout\n    |     fairy = _ConnectionRecord.checkout(pool)\n    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 716, in checkout\n    |     rec = pool._do_get()\n    |           ^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get\n    |     with util.safe_reraise():\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__\n    |     raise exc_value.with_traceback(exc_tb)\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 167, in _do_get\n    |     return self._create_connection()\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 393, in _create_connection\n    |     return _ConnectionRecord(self)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 678, in __init__\n    |     self.__connect()\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 902, in __connect\n    |     with util.safe_reraise():\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__\n    |     raise exc_value.with_traceback(exc_tb)\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 898, in __connect\n    |     self.dbapi_connection = connection = pool._invoke_creator(self)\n    |                                          ^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/create.py", line 637, in connect\n    |     return dialect.connect(*cargs, **cparams)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 615, in connect\n    |     return self.loaded_dbapi.connect(*cargs, **cparams)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/psycopg2/__init__.py", line 122, in connect\n    |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    | psycopg2.OperationalError: connection to server at "localhost" (::1), port 5432 failed: Connection refused\n    | \tIs the server running on that host and accepting TCP/IP connections?\n    | connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused\n    | \tIs the server running on that host and accepting TCP/IP connections?\n    | \n    | \n    | The above exception was the direct cause of the following exception:\n    | \n    | Traceback (most recent call last):\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 108, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/app/app/logging/logging_interceptor.py", line 17, in log_request\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 84, in call_next\n    |     raise app_exc\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 70, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File "/usr/local/lib/python3.11/site-packages/prometheus_fastapi_instrumentator/middleware.py", line 155, in __call__\n    |     raise exc\n    |   File "/usr/local/lib/python3.11/site-packages/prometheus_fastapi_instrumentator/middleware.py", line 153, in __call__\n    |     await self.app(scope, receive, send_wrapper)\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__\n    |     raise exc\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__\n    |     await self.app(scope, receive, sender)\n    |   File "/usr/local/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 21, in __call__\n    |     raise e\n    |   File "/usr/local/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__\n    |     await route.handle(scope, receive, send)\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle\n    |     await self.app(scope, receive, send)\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 66, in app\n    |     response = await func(request)\n    |                ^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 237, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 163, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/app/app/router/resumo_router.py", line 13, in obter_resumo\n    |     return resumo_service.obter_resumo_existente(url)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/app/app/service/resumo_service.py", line 56, in obter_resumo_existente\n    |     resumo = self.resumo_repository.buscar_por_url(url)\n    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/app/app/dataprovider/database/repository/resumo_repository.py", line 20, in buscar_por_url\n    |     return self.db.query(Resumo).filter(Resumo.url == url).first()\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2743, in first\n    |     return self.limit(1)._iter().first()  # type: ignore\n    |            ^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2842, in _iter\n    |     result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(\n    |                                                   ^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2262, in execute\n    |     return self._execute_internal(\n    |            ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2134, in _execute_internal\n    |     conn = self._connection_for_bind(bind)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2001, in _connection_for_bind\n    |     return trans._connection_for_bind(engine, execution_options)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "<string>", line 2, in _connection_for_bind\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go\n    |     ret_value = fn(self, *arg, **kw)\n    |                 ^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1126, in _connection_for_bind\n    |     conn = bind.connect()\n    |            ^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3264, in connect\n    |     return self._connection_cls(self)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 147, in __init__\n    |     Connection._handle_dbapi_exception_noconnection(\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2426, in _handle_dbapi_exception_noconnection\n    |     raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 145, in __init__\n    |     self._dbapi_connection = engine.raw_connection()\n    |                              ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3288, in raw_connection\n    |     return self.pool.connect()\n    |            ^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 452, in connect\n    |     return _ConnectionFairy._checkout(self)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 1267, in _checkout\n    |     fairy = _ConnectionRecord.checkout(pool)\n    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 716, in checkout\n    |     rec = pool._do_get()\n    |           ^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get\n    |     with util.safe_reraise():\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__\n    |     raise exc_value.with_traceback(exc_tb)\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 167, in _do_get\n    |     return self._create_connection()\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 393, in _create_connection\n    |     return _ConnectionRecord(self)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 678, in __init__\n    |     self.__connect()\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 902, in __connect\n    |     with util.safe_reraise():\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__\n    |     raise exc_value.with_traceback(exc_tb)\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 898, in __connect\n    |     self.dbapi_connection = connection = pool._invoke_creator(self)\n    |                                          ^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/create.py", line 637, in connect\n    |     return dialect.connect(*cargs, **cparams)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 615, in connect\n    |     return self.loaded_dbapi.connect(*cargs, **cparams)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/psycopg2/__init__.py", line 122, in connect\n    |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    | sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: Connection refused\n    | \tIs the server running on that host and accepting TCP/IP connections?\n    | connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused\n    | \tIs the server running on that host and accepting TCP/IP connections?\n    | \n    | (Background on this error at: https://sqlalche.me/e/20/e3q8)\n    +------------------------------------\n'}, 'request': {'method': 'GET', 'url': 'http://localhost:8080/resumos?url=https%3A%2F%2Fwww.wikipedia.org%2Fteste', 'headers': {'host': 'localhost:8080', 'user-agent': 'insomnia/10.0.0', 'correlationid': '12345', 'accept': '*/*'}}}
2024-10-01 02:56:04,697 - app.exception.handler_excecao - ERROR - {'correlation_id': '12345', 'error': {'type': 'ExceptionGroup', 'message': 'unhandled errors in a TaskGroup (1 sub-exception)', 'traceback': 'Traceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 108, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/app/app/logging/logging_interceptor.py", line 17, in log_request\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 84, in call_next\n    raise app_exc\n  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File "/usr/local/lib/python3.11/site-packages/prometheus_fastapi_instrumentator/middleware.py", line 155, in __call__\n    raise exc\n  File "/usr/local/lib/python3.11/site-packages/prometheus_fastapi_instrumentator/middleware.py", line 153, in __call__\n    await self.app(scope, receive, send_wrapper)\n  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__\n    raise exc\n  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__\n    await self.app(scope, receive, sender)\n  File "/usr/local/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 21, in __call__\n    raise e\n  File "/usr/local/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__\n    await self.app(scope, receive, send)\n  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__\n    await route.handle(scope, receive, send)\n  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle\n    await self.app(scope, receive, send)\n  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 66, in app\n    response = await func(request)\n               ^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 237, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 163, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/app/app/router/resumo_router.py", line 13, in obter_resumo\n    return resumo_service.obter_resumo_existente(url)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/app/app/service/resumo_service.py", line 56, in obter_resumo_existente\n    resumo = self.resumo_repository.buscar_por_url(url)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/app/app/dataprovider/database/repository/resumo_repository.py", line 20, in buscar_por_url\n    return self.db.query(Resumo).filter(Resumo.url == url).first()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2743, in first\n    return self.limit(1)._iter().first()  # type: ignore\n           ^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2842, in _iter\n    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(\n                                                  ^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2262, in execute\n    return self._execute_internal(\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2134, in _execute_internal\n    conn = self._connection_for_bind(bind)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2001, in _connection_for_bind\n    return trans._connection_for_bind(engine, execution_options)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "<string>", line 2, in _connection_for_bind\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1126, in _connection_for_bind\n    conn = bind.connect()\n           ^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3264, in connect\n    return self._connection_cls(self)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 147, in __init__\n    Connection._handle_dbapi_exception_noconnection(\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2426, in _handle_dbapi_exception_noconnection\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 145, in __init__\n    self._dbapi_connection = engine.raw_connection()\n                             ^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3288, in raw_connection\n    return self.pool.connect()\n           ^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 452, in connect\n    return _ConnectionFairy._checkout(self)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 1267, in _checkout\n    fairy = _ConnectionRecord.checkout(pool)\n            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 716, in checkout\n    rec = pool._do_get()\n          ^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get\n    with util.safe_reraise():\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 167, in _do_get\n    return self._create_connection()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 393, in _create_connection\n    return _ConnectionRecord(self)\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 678, in __init__\n    self.__connect()\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 902, in __connect\n    with util.safe_reraise():\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 898, in __connect\n    self.dbapi_connection = connection = pool._invoke_creator(self)\n                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/create.py", line 637, in connect\n    return dialect.connect(*cargs, **cparams)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 615, in connect\n    return self.loaded_dbapi.connect(*cargs, **cparams)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/psycopg2/__init__.py", line 122, in connect\n    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nsqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: Connection refused\n\tIs the server running on that host and accepting TCP/IP connections?\nconnection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused\n\tIs the server running on that host and accepting TCP/IP connections?\n\n(Background on this error at: https://sqlalche.me/e/20/e3q8)\n\nDuring handling of the above exception, another exception occurred:\n\n  + Exception Group Traceback (most recent call last):\n  |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__\n  |     await self.app(scope, receive, _send)\n  |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 106, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |   File "/usr/local/lib/python3.11/site-packages/anyio/_backends/_asyncio.py", line 736, in __aexit__\n  |     raise BaseExceptionGroup(\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 145, in __init__\n    |     self._dbapi_connection = engine.raw_connection()\n    |                              ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3288, in raw_connection\n    |     return self.pool.connect()\n    |            ^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 452, in connect\n    |     return _ConnectionFairy._checkout(self)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 1267, in _checkout\n    |     fairy = _ConnectionRecord.checkout(pool)\n    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 716, in checkout\n    |     rec = pool._do_get()\n    |           ^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get\n    |     with util.safe_reraise():\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__\n    |     raise exc_value.with_traceback(exc_tb)\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 167, in _do_get\n    |     return self._create_connection()\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 393, in _create_connection\n    |     return _ConnectionRecord(self)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 678, in __init__\n    |     self.__connect()\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 902, in __connect\n    |     with util.safe_reraise():\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__\n    |     raise exc_value.with_traceback(exc_tb)\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 898, in __connect\n    |     self.dbapi_connection = connection = pool._invoke_creator(self)\n    |                                          ^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/create.py", line 637, in connect\n    |     return dialect.connect(*cargs, **cparams)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 615, in connect\n    |     return self.loaded_dbapi.connect(*cargs, **cparams)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/psycopg2/__init__.py", line 122, in connect\n    |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    | psycopg2.OperationalError: connection to server at "localhost" (::1), port 5432 failed: Connection refused\n    | \tIs the server running on that host and accepting TCP/IP connections?\n    | connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused\n    | \tIs the server running on that host and accepting TCP/IP connections?\n    | \n    | \n    | The above exception was the direct cause of the following exception:\n    | \n    | Traceback (most recent call last):\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 108, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/app/app/logging/logging_interceptor.py", line 17, in log_request\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 84, in call_next\n    |     raise app_exc\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 70, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File "/usr/local/lib/python3.11/site-packages/prometheus_fastapi_instrumentator/middleware.py", line 155, in __call__\n    |     raise exc\n    |   File "/usr/local/lib/python3.11/site-packages/prometheus_fastapi_instrumentator/middleware.py", line 153, in __call__\n    |     await self.app(scope, receive, send_wrapper)\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__\n    |     raise exc\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__\n    |     await self.app(scope, receive, sender)\n    |   File "/usr/local/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 21, in __call__\n    |     raise e\n    |   File "/usr/local/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__\n    |     await route.handle(scope, receive, send)\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle\n    |     await self.app(scope, receive, send)\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 66, in app\n    |     response = await func(request)\n    |                ^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 237, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 163, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/app/app/router/resumo_router.py", line 13, in obter_resumo\n    |     return resumo_service.obter_resumo_existente(url)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/app/app/service/resumo_service.py", line 56, in obter_resumo_existente\n    |     resumo = self.resumo_repository.buscar_por_url(url)\n    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/app/app/dataprovider/database/repository/resumo_repository.py", line 20, in buscar_por_url\n    |     return self.db.query(Resumo).filter(Resumo.url == url).first()\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2743, in first\n    |     return self.limit(1)._iter().first()  # type: ignore\n    |            ^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2842, in _iter\n    |     result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(\n    |                                                   ^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2262, in execute\n    |     return self._execute_internal(\n    |            ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2134, in _execute_internal\n    |     conn = self._connection_for_bind(bind)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2001, in _connection_for_bind\n    |     return trans._connection_for_bind(engine, execution_options)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "<string>", line 2, in _connection_for_bind\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go\n    |     ret_value = fn(self, *arg, **kw)\n    |                 ^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1126, in _connection_for_bind\n    |     conn = bind.connect()\n    |            ^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3264, in connect\n    |     return self._connection_cls(self)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 147, in __init__\n    |     Connection._handle_dbapi_exception_noconnection(\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2426, in _handle_dbapi_exception_noconnection\n    |     raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 145, in __init__\n    |     self._dbapi_connection = engine.raw_connection()\n    |                              ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3288, in raw_connection\n    |     return self.pool.connect()\n    |            ^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 452, in connect\n    |     return _ConnectionFairy._checkout(self)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 1267, in _checkout\n    |     fairy = _ConnectionRecord.checkout(pool)\n    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 716, in checkout\n    |     rec = pool._do_get()\n    |           ^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get\n    |     with util.safe_reraise():\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__\n    |     raise exc_value.with_traceback(exc_tb)\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 167, in _do_get\n    |     return self._create_connection()\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 393, in _create_connection\n    |     return _ConnectionRecord(self)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 678, in __init__\n    |     self.__connect()\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 902, in __connect\n    |     with util.safe_reraise():\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__\n    |     raise exc_value.with_traceback(exc_tb)\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 898, in __connect\n    |     self.dbapi_connection = connection = pool._invoke_creator(self)\n    |                                          ^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/create.py", line 637, in connect\n    |     return dialect.connect(*cargs, **cparams)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 615, in connect\n    |     return self.loaded_dbapi.connect(*cargs, **cparams)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/psycopg2/__init__.py", line 122, in connect\n    |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    | sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: Connection refused\n    | \tIs the server running on that host and accepting TCP/IP connections?\n    | connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused\n    | \tIs the server running on that host and accepting TCP/IP connections?\n    | \n    | (Background on this error at: https://sqlalche.me/e/20/e3q8)\n    +------------------------------------\n'}, 'request': {'method': 'GET', 'url': 'http://localhost:8080/resumos?url=https%3A%2F%2Fwww.wikipedia.org%2Fteste', 'headers': {'host': 'localhost:8080', 'user-agent': 'insomnia/10.0.0', 'correlationid': '12345', 'accept': '*/*'}}}
2024-10-01 02:56:05,106 - app.exception.handler_excecao - ERROR - {'correlation_id': '12345', 'error': {'type': 'ExceptionGroup', 'message': 'unhandled errors in a TaskGroup (1 sub-exception)', 'traceback': 'Traceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 108, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/app/app/logging/logging_interceptor.py", line 17, in log_request\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 84, in call_next\n    raise app_exc\n  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File "/usr/local/lib/python3.11/site-packages/prometheus_fastapi_instrumentator/middleware.py", line 155, in __call__\n    raise exc\n  File "/usr/local/lib/python3.11/site-packages/prometheus_fastapi_instrumentator/middleware.py", line 153, in __call__\n    await self.app(scope, receive, send_wrapper)\n  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__\n    raise exc\n  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__\n    await self.app(scope, receive, sender)\n  File "/usr/local/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 21, in __call__\n    raise e\n  File "/usr/local/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__\n    await self.app(scope, receive, send)\n  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__\n    await route.handle(scope, receive, send)\n  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle\n    await self.app(scope, receive, send)\n  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 66, in app\n    response = await func(request)\n               ^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 237, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 163, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/app/app/router/resumo_router.py", line 13, in obter_resumo\n    return resumo_service.obter_resumo_existente(url)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/app/app/service/resumo_service.py", line 56, in obter_resumo_existente\n    resumo = self.resumo_repository.buscar_por_url(url)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/app/app/dataprovider/database/repository/resumo_repository.py", line 20, in buscar_por_url\n    return self.db.query(Resumo).filter(Resumo.url == url).first()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2743, in first\n    return self.limit(1)._iter().first()  # type: ignore\n           ^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2842, in _iter\n    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(\n                                                  ^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2262, in execute\n    return self._execute_internal(\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2134, in _execute_internal\n    conn = self._connection_for_bind(bind)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2001, in _connection_for_bind\n    return trans._connection_for_bind(engine, execution_options)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "<string>", line 2, in _connection_for_bind\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1126, in _connection_for_bind\n    conn = bind.connect()\n           ^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3264, in connect\n    return self._connection_cls(self)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 147, in __init__\n    Connection._handle_dbapi_exception_noconnection(\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2426, in _handle_dbapi_exception_noconnection\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 145, in __init__\n    self._dbapi_connection = engine.raw_connection()\n                             ^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3288, in raw_connection\n    return self.pool.connect()\n           ^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 452, in connect\n    return _ConnectionFairy._checkout(self)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 1267, in _checkout\n    fairy = _ConnectionRecord.checkout(pool)\n            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 716, in checkout\n    rec = pool._do_get()\n          ^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get\n    with util.safe_reraise():\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 167, in _do_get\n    return self._create_connection()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 393, in _create_connection\n    return _ConnectionRecord(self)\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 678, in __init__\n    self.__connect()\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 902, in __connect\n    with util.safe_reraise():\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 898, in __connect\n    self.dbapi_connection = connection = pool._invoke_creator(self)\n                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/create.py", line 637, in connect\n    return dialect.connect(*cargs, **cparams)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 615, in connect\n    return self.loaded_dbapi.connect(*cargs, **cparams)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/psycopg2/__init__.py", line 122, in connect\n    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nsqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: Connection refused\n\tIs the server running on that host and accepting TCP/IP connections?\nconnection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused\n\tIs the server running on that host and accepting TCP/IP connections?\n\n(Background on this error at: https://sqlalche.me/e/20/e3q8)\n\nDuring handling of the above exception, another exception occurred:\n\n  + Exception Group Traceback (most recent call last):\n  |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__\n  |     await self.app(scope, receive, _send)\n  |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 106, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |   File "/usr/local/lib/python3.11/site-packages/anyio/_backends/_asyncio.py", line 736, in __aexit__\n  |     raise BaseExceptionGroup(\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 145, in __init__\n    |     self._dbapi_connection = engine.raw_connection()\n    |                              ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3288, in raw_connection\n    |     return self.pool.connect()\n    |            ^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 452, in connect\n    |     return _ConnectionFairy._checkout(self)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 1267, in _checkout\n    |     fairy = _ConnectionRecord.checkout(pool)\n    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 716, in checkout\n    |     rec = pool._do_get()\n    |           ^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get\n    |     with util.safe_reraise():\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__\n    |     raise exc_value.with_traceback(exc_tb)\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 167, in _do_get\n    |     return self._create_connection()\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 393, in _create_connection\n    |     return _ConnectionRecord(self)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 678, in __init__\n    |     self.__connect()\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 902, in __connect\n    |     with util.safe_reraise():\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__\n    |     raise exc_value.with_traceback(exc_tb)\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 898, in __connect\n    |     self.dbapi_connection = connection = pool._invoke_creator(self)\n    |                                          ^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/create.py", line 637, in connect\n    |     return dialect.connect(*cargs, **cparams)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 615, in connect\n    |     return self.loaded_dbapi.connect(*cargs, **cparams)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/psycopg2/__init__.py", line 122, in connect\n    |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    | psycopg2.OperationalError: connection to server at "localhost" (::1), port 5432 failed: Connection refused\n    | \tIs the server running on that host and accepting TCP/IP connections?\n    | connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused\n    | \tIs the server running on that host and accepting TCP/IP connections?\n    | \n    | \n    | The above exception was the direct cause of the following exception:\n    | \n    | Traceback (most recent call last):\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 108, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/app/app/logging/logging_interceptor.py", line 17, in log_request\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 84, in call_next\n    |     raise app_exc\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 70, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File "/usr/local/lib/python3.11/site-packages/prometheus_fastapi_instrumentator/middleware.py", line 155, in __call__\n    |     raise exc\n    |   File "/usr/local/lib/python3.11/site-packages/prometheus_fastapi_instrumentator/middleware.py", line 153, in __call__\n    |     await self.app(scope, receive, send_wrapper)\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__\n    |     raise exc\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__\n    |     await self.app(scope, receive, sender)\n    |   File "/usr/local/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 21, in __call__\n    |     raise e\n    |   File "/usr/local/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__\n    |     await route.handle(scope, receive, send)\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle\n    |     await self.app(scope, receive, send)\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 66, in app\n    |     response = await func(request)\n    |                ^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 237, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 163, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/app/app/router/resumo_router.py", line 13, in obter_resumo\n    |     return resumo_service.obter_resumo_existente(url)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/app/app/service/resumo_service.py", line 56, in obter_resumo_existente\n    |     resumo = self.resumo_repository.buscar_por_url(url)\n    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/app/app/dataprovider/database/repository/resumo_repository.py", line 20, in buscar_por_url\n    |     return self.db.query(Resumo).filter(Resumo.url == url).first()\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2743, in first\n    |     return self.limit(1)._iter().first()  # type: ignore\n    |            ^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2842, in _iter\n    |     result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(\n    |                                                   ^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2262, in execute\n    |     return self._execute_internal(\n    |            ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2134, in _execute_internal\n    |     conn = self._connection_for_bind(bind)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2001, in _connection_for_bind\n    |     return trans._connection_for_bind(engine, execution_options)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "<string>", line 2, in _connection_for_bind\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go\n    |     ret_value = fn(self, *arg, **kw)\n    |                 ^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1126, in _connection_for_bind\n    |     conn = bind.connect()\n    |            ^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3264, in connect\n    |     return self._connection_cls(self)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 147, in __init__\n    |     Connection._handle_dbapi_exception_noconnection(\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2426, in _handle_dbapi_exception_noconnection\n    |     raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 145, in __init__\n    |     self._dbapi_connection = engine.raw_connection()\n    |                              ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3288, in raw_connection\n    |     return self.pool.connect()\n    |            ^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 452, in connect\n    |     return _ConnectionFairy._checkout(self)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 1267, in _checkout\n    |     fairy = _ConnectionRecord.checkout(pool)\n    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 716, in checkout\n    |     rec = pool._do_get()\n    |           ^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get\n    |     with util.safe_reraise():\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__\n    |     raise exc_value.with_traceback(exc_tb)\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 167, in _do_get\n    |     return self._create_connection()\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 393, in _create_connection\n    |     return _ConnectionRecord(self)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 678, in __init__\n    |     self.__connect()\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 902, in __connect\n    |     with util.safe_reraise():\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__\n    |     raise exc_value.with_traceback(exc_tb)\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 898, in __connect\n    |     self.dbapi_connection = connection = pool._invoke_creator(self)\n    |                                          ^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/create.py", line 637, in connect\n    |     return dialect.connect(*cargs, **cparams)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 615, in connect\n    |     return self.loaded_dbapi.connect(*cargs, **cparams)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/psycopg2/__init__.py", line 122, in connect\n    |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    | sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: Connection refused\n    | \tIs the server running on that host and accepting TCP/IP connections?\n    | connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused\n    | \tIs the server running on that host and accepting TCP/IP connections?\n    | \n    | (Background on this error at: https://sqlalche.me/e/20/e3q8)\n    +------------------------------------\n'}, 'request': {'method': 'GET', 'url': 'http://localhost:8080/resumos?url=https%3A%2F%2Fwww.wikipedia.org%2Fteste', 'headers': {'host': 'localhost:8080', 'user-agent': 'insomnia/10.0.0', 'correlationid': '12345', 'accept': '*/*'}}}
2024-10-01 02:56:05,784 - app.exception.handler_excecao - ERROR - {'correlation_id': '12345', 'error': {'type': 'ExceptionGroup', 'message': 'unhandled errors in a TaskGroup (1 sub-exception)', 'traceback': 'Traceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 108, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/app/app/logging/logging_interceptor.py", line 17, in log_request\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 84, in call_next\n    raise app_exc\n  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File "/usr/local/lib/python3.11/site-packages/prometheus_fastapi_instrumentator/middleware.py", line 155, in __call__\n    raise exc\n  File "/usr/local/lib/python3.11/site-packages/prometheus_fastapi_instrumentator/middleware.py", line 153, in __call__\n    await self.app(scope, receive, send_wrapper)\n  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__\n    raise exc\n  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__\n    await self.app(scope, receive, sender)\n  File "/usr/local/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 21, in __call__\n    raise e\n  File "/usr/local/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__\n    await self.app(scope, receive, send)\n  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__\n    await route.handle(scope, receive, send)\n  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle\n    await self.app(scope, receive, send)\n  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 66, in app\n    response = await func(request)\n               ^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 237, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 163, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/app/app/router/resumo_router.py", line 13, in obter_resumo\n    return resumo_service.obter_resumo_existente(url)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/app/app/service/resumo_service.py", line 56, in obter_resumo_existente\n    resumo = self.resumo_repository.buscar_por_url(url)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/app/app/dataprovider/database/repository/resumo_repository.py", line 20, in buscar_por_url\n    return self.db.query(Resumo).filter(Resumo.url == url).first()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2743, in first\n    return self.limit(1)._iter().first()  # type: ignore\n           ^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2842, in _iter\n    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(\n                                                  ^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2262, in execute\n    return self._execute_internal(\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2134, in _execute_internal\n    conn = self._connection_for_bind(bind)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2001, in _connection_for_bind\n    return trans._connection_for_bind(engine, execution_options)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "<string>", line 2, in _connection_for_bind\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1126, in _connection_for_bind\n    conn = bind.connect()\n           ^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3264, in connect\n    return self._connection_cls(self)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 147, in __init__\n    Connection._handle_dbapi_exception_noconnection(\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2426, in _handle_dbapi_exception_noconnection\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 145, in __init__\n    self._dbapi_connection = engine.raw_connection()\n                             ^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3288, in raw_connection\n    return self.pool.connect()\n           ^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 452, in connect\n    return _ConnectionFairy._checkout(self)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 1267, in _checkout\n    fairy = _ConnectionRecord.checkout(pool)\n            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 716, in checkout\n    rec = pool._do_get()\n          ^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get\n    with util.safe_reraise():\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 167, in _do_get\n    return self._create_connection()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 393, in _create_connection\n    return _ConnectionRecord(self)\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 678, in __init__\n    self.__connect()\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 902, in __connect\n    with util.safe_reraise():\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 898, in __connect\n    self.dbapi_connection = connection = pool._invoke_creator(self)\n                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/create.py", line 637, in connect\n    return dialect.connect(*cargs, **cparams)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 615, in connect\n    return self.loaded_dbapi.connect(*cargs, **cparams)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/psycopg2/__init__.py", line 122, in connect\n    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nsqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: Connection refused\n\tIs the server running on that host and accepting TCP/IP connections?\nconnection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused\n\tIs the server running on that host and accepting TCP/IP connections?\n\n(Background on this error at: https://sqlalche.me/e/20/e3q8)\n\nDuring handling of the above exception, another exception occurred:\n\n  + Exception Group Traceback (most recent call last):\n  |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__\n  |     await self.app(scope, receive, _send)\n  |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 106, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |   File "/usr/local/lib/python3.11/site-packages/anyio/_backends/_asyncio.py", line 736, in __aexit__\n  |     raise BaseExceptionGroup(\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 145, in __init__\n    |     self._dbapi_connection = engine.raw_connection()\n    |                              ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3288, in raw_connection\n    |     return self.pool.connect()\n    |            ^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 452, in connect\n    |     return _ConnectionFairy._checkout(self)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 1267, in _checkout\n    |     fairy = _ConnectionRecord.checkout(pool)\n    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 716, in checkout\n    |     rec = pool._do_get()\n    |           ^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get\n    |     with util.safe_reraise():\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__\n    |     raise exc_value.with_traceback(exc_tb)\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 167, in _do_get\n    |     return self._create_connection()\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 393, in _create_connection\n    |     return _ConnectionRecord(self)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 678, in __init__\n    |     self.__connect()\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 902, in __connect\n    |     with util.safe_reraise():\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__\n    |     raise exc_value.with_traceback(exc_tb)\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 898, in __connect\n    |     self.dbapi_connection = connection = pool._invoke_creator(self)\n    |                                          ^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/create.py", line 637, in connect\n    |     return dialect.connect(*cargs, **cparams)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 615, in connect\n    |     return self.loaded_dbapi.connect(*cargs, **cparams)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/psycopg2/__init__.py", line 122, in connect\n    |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    | psycopg2.OperationalError: connection to server at "localhost" (::1), port 5432 failed: Connection refused\n    | \tIs the server running on that host and accepting TCP/IP connections?\n    | connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused\n    | \tIs the server running on that host and accepting TCP/IP connections?\n    | \n    | \n    | The above exception was the direct cause of the following exception:\n    | \n    | Traceback (most recent call last):\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 108, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/app/app/logging/logging_interceptor.py", line 17, in log_request\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 84, in call_next\n    |     raise app_exc\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 70, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File "/usr/local/lib/python3.11/site-packages/prometheus_fastapi_instrumentator/middleware.py", line 155, in __call__\n    |     raise exc\n    |   File "/usr/local/lib/python3.11/site-packages/prometheus_fastapi_instrumentator/middleware.py", line 153, in __call__\n    |     await self.app(scope, receive, send_wrapper)\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__\n    |     raise exc\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__\n    |     await self.app(scope, receive, sender)\n    |   File "/usr/local/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 21, in __call__\n    |     raise e\n    |   File "/usr/local/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__\n    |     await route.handle(scope, receive, send)\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle\n    |     await self.app(scope, receive, send)\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 66, in app\n    |     response = await func(request)\n    |                ^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 237, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 163, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/app/app/router/resumo_router.py", line 13, in obter_resumo\n    |     return resumo_service.obter_resumo_existente(url)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/app/app/service/resumo_service.py", line 56, in obter_resumo_existente\n    |     resumo = self.resumo_repository.buscar_por_url(url)\n    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/app/app/dataprovider/database/repository/resumo_repository.py", line 20, in buscar_por_url\n    |     return self.db.query(Resumo).filter(Resumo.url == url).first()\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2743, in first\n    |     return self.limit(1)._iter().first()  # type: ignore\n    |            ^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2842, in _iter\n    |     result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(\n    |                                                   ^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2262, in execute\n    |     return self._execute_internal(\n    |            ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2134, in _execute_internal\n    |     conn = self._connection_for_bind(bind)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2001, in _connection_for_bind\n    |     return trans._connection_for_bind(engine, execution_options)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "<string>", line 2, in _connection_for_bind\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go\n    |     ret_value = fn(self, *arg, **kw)\n    |                 ^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1126, in _connection_for_bind\n    |     conn = bind.connect()\n    |            ^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3264, in connect\n    |     return self._connection_cls(self)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 147, in __init__\n    |     Connection._handle_dbapi_exception_noconnection(\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2426, in _handle_dbapi_exception_noconnection\n    |     raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 145, in __init__\n    |     self._dbapi_connection = engine.raw_connection()\n    |                              ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3288, in raw_connection\n    |     return self.pool.connect()\n    |            ^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 452, in connect\n    |     return _ConnectionFairy._checkout(self)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 1267, in _checkout\n    |     fairy = _ConnectionRecord.checkout(pool)\n    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 716, in checkout\n    |     rec = pool._do_get()\n    |           ^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get\n    |     with util.safe_reraise():\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__\n    |     raise exc_value.with_traceback(exc_tb)\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 167, in _do_get\n    |     return self._create_connection()\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 393, in _create_connection\n    |     return _ConnectionRecord(self)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 678, in __init__\n    |     self.__connect()\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 902, in __connect\n    |     with util.safe_reraise():\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__\n    |     raise exc_value.with_traceback(exc_tb)\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 898, in __connect\n    |     self.dbapi_connection = connection = pool._invoke_creator(self)\n    |                                          ^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/create.py", line 637, in connect\n    |     return dialect.connect(*cargs, **cparams)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 615, in connect\n    |     return self.loaded_dbapi.connect(*cargs, **cparams)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/psycopg2/__init__.py", line 122, in connect\n    |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    | sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: Connection refused\n    | \tIs the server running on that host and accepting TCP/IP connections?\n    | connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused\n    | \tIs the server running on that host and accepting TCP/IP connections?\n    | \n    | (Background on this error at: https://sqlalche.me/e/20/e3q8)\n    +------------------------------------\n'}, 'request': {'method': 'GET', 'url': 'http://localhost:8080/resumos?url=https%3A%2F%2Fwww.wikipedia.org%2Fteste', 'headers': {'host': 'localhost:8080', 'user-agent': 'insomnia/10.0.0', 'correlationid': '12345', 'accept': '*/*'}}}
2024-10-01 02:56:06,252 - app.exception.handler_excecao - ERROR - {'correlation_id': '12345', 'error': {'type': 'ExceptionGroup', 'message': 'unhandled errors in a TaskGroup (1 sub-exception)', 'traceback': 'Traceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 108, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/app/app/logging/logging_interceptor.py", line 17, in log_request\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 84, in call_next\n    raise app_exc\n  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File "/usr/local/lib/python3.11/site-packages/prometheus_fastapi_instrumentator/middleware.py", line 155, in __call__\n    raise exc\n  File "/usr/local/lib/python3.11/site-packages/prometheus_fastapi_instrumentator/middleware.py", line 153, in __call__\n    await self.app(scope, receive, send_wrapper)\n  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__\n    raise exc\n  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__\n    await self.app(scope, receive, sender)\n  File "/usr/local/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 21, in __call__\n    raise e\n  File "/usr/local/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__\n    await self.app(scope, receive, send)\n  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__\n    await route.handle(scope, receive, send)\n  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle\n    await self.app(scope, receive, send)\n  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 66, in app\n    response = await func(request)\n               ^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 237, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 163, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/app/app/router/resumo_router.py", line 13, in obter_resumo\n    return resumo_service.obter_resumo_existente(url)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/app/app/service/resumo_service.py", line 56, in obter_resumo_existente\n    resumo = self.resumo_repository.buscar_por_url(url)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/app/app/dataprovider/database/repository/resumo_repository.py", line 20, in buscar_por_url\n    return self.db.query(Resumo).filter(Resumo.url == url).first()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2743, in first\n    return self.limit(1)._iter().first()  # type: ignore\n           ^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2842, in _iter\n    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(\n                                                  ^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2262, in execute\n    return self._execute_internal(\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2134, in _execute_internal\n    conn = self._connection_for_bind(bind)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2001, in _connection_for_bind\n    return trans._connection_for_bind(engine, execution_options)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "<string>", line 2, in _connection_for_bind\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1126, in _connection_for_bind\n    conn = bind.connect()\n           ^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3264, in connect\n    return self._connection_cls(self)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 147, in __init__\n    Connection._handle_dbapi_exception_noconnection(\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2426, in _handle_dbapi_exception_noconnection\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 145, in __init__\n    self._dbapi_connection = engine.raw_connection()\n                             ^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3288, in raw_connection\n    return self.pool.connect()\n           ^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 452, in connect\n    return _ConnectionFairy._checkout(self)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 1267, in _checkout\n    fairy = _ConnectionRecord.checkout(pool)\n            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 716, in checkout\n    rec = pool._do_get()\n          ^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get\n    with util.safe_reraise():\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 167, in _do_get\n    return self._create_connection()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 393, in _create_connection\n    return _ConnectionRecord(self)\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 678, in __init__\n    self.__connect()\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 902, in __connect\n    with util.safe_reraise():\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 898, in __connect\n    self.dbapi_connection = connection = pool._invoke_creator(self)\n                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/create.py", line 637, in connect\n    return dialect.connect(*cargs, **cparams)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 615, in connect\n    return self.loaded_dbapi.connect(*cargs, **cparams)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/psycopg2/__init__.py", line 122, in connect\n    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nsqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: Connection refused\n\tIs the server running on that host and accepting TCP/IP connections?\nconnection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused\n\tIs the server running on that host and accepting TCP/IP connections?\n\n(Background on this error at: https://sqlalche.me/e/20/e3q8)\n\nDuring handling of the above exception, another exception occurred:\n\n  + Exception Group Traceback (most recent call last):\n  |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__\n  |     await self.app(scope, receive, _send)\n  |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 106, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |   File "/usr/local/lib/python3.11/site-packages/anyio/_backends/_asyncio.py", line 736, in __aexit__\n  |     raise BaseExceptionGroup(\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 145, in __init__\n    |     self._dbapi_connection = engine.raw_connection()\n    |                              ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3288, in raw_connection\n    |     return self.pool.connect()\n    |            ^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 452, in connect\n    |     return _ConnectionFairy._checkout(self)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 1267, in _checkout\n    |     fairy = _ConnectionRecord.checkout(pool)\n    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 716, in checkout\n    |     rec = pool._do_get()\n    |           ^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get\n    |     with util.safe_reraise():\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__\n    |     raise exc_value.with_traceback(exc_tb)\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 167, in _do_get\n    |     return self._create_connection()\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 393, in _create_connection\n    |     return _ConnectionRecord(self)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 678, in __init__\n    |     self.__connect()\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 902, in __connect\n    |     with util.safe_reraise():\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__\n    |     raise exc_value.with_traceback(exc_tb)\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 898, in __connect\n    |     self.dbapi_connection = connection = pool._invoke_creator(self)\n    |                                          ^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/create.py", line 637, in connect\n    |     return dialect.connect(*cargs, **cparams)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 615, in connect\n    |     return self.loaded_dbapi.connect(*cargs, **cparams)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/psycopg2/__init__.py", line 122, in connect\n    |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    | psycopg2.OperationalError: connection to server at "localhost" (::1), port 5432 failed: Connection refused\n    | \tIs the server running on that host and accepting TCP/IP connections?\n    | connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused\n    | \tIs the server running on that host and accepting TCP/IP connections?\n    | \n    | \n    | The above exception was the direct cause of the following exception:\n    | \n    | Traceback (most recent call last):\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 108, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/app/app/logging/logging_interceptor.py", line 17, in log_request\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 84, in call_next\n    |     raise app_exc\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 70, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File "/usr/local/lib/python3.11/site-packages/prometheus_fastapi_instrumentator/middleware.py", line 155, in __call__\n    |     raise exc\n    |   File "/usr/local/lib/python3.11/site-packages/prometheus_fastapi_instrumentator/middleware.py", line 153, in __call__\n    |     await self.app(scope, receive, send_wrapper)\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__\n    |     raise exc\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__\n    |     await self.app(scope, receive, sender)\n    |   File "/usr/local/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 21, in __call__\n    |     raise e\n    |   File "/usr/local/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__\n    |     await route.handle(scope, receive, send)\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle\n    |     await self.app(scope, receive, send)\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 66, in app\n    |     response = await func(request)\n    |                ^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 237, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 163, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/app/app/router/resumo_router.py", line 13, in obter_resumo\n    |     return resumo_service.obter_resumo_existente(url)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/app/app/service/resumo_service.py", line 56, in obter_resumo_existente\n    |     resumo = self.resumo_repository.buscar_por_url(url)\n    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/app/app/dataprovider/database/repository/resumo_repository.py", line 20, in buscar_por_url\n    |     return self.db.query(Resumo).filter(Resumo.url == url).first()\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2743, in first\n    |     return self.limit(1)._iter().first()  # type: ignore\n    |            ^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2842, in _iter\n    |     result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(\n    |                                                   ^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2262, in execute\n    |     return self._execute_internal(\n    |            ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2134, in _execute_internal\n    |     conn = self._connection_for_bind(bind)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2001, in _connection_for_bind\n    |     return trans._connection_for_bind(engine, execution_options)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "<string>", line 2, in _connection_for_bind\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go\n    |     ret_value = fn(self, *arg, **kw)\n    |                 ^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1126, in _connection_for_bind\n    |     conn = bind.connect()\n    |            ^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3264, in connect\n    |     return self._connection_cls(self)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 147, in __init__\n    |     Connection._handle_dbapi_exception_noconnection(\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2426, in _handle_dbapi_exception_noconnection\n    |     raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 145, in __init__\n    |     self._dbapi_connection = engine.raw_connection()\n    |                              ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3288, in raw_connection\n    |     return self.pool.connect()\n    |            ^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 452, in connect\n    |     return _ConnectionFairy._checkout(self)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 1267, in _checkout\n    |     fairy = _ConnectionRecord.checkout(pool)\n    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 716, in checkout\n    |     rec = pool._do_get()\n    |           ^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get\n    |     with util.safe_reraise():\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__\n    |     raise exc_value.with_traceback(exc_tb)\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 167, in _do_get\n    |     return self._create_connection()\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 393, in _create_connection\n    |     return _ConnectionRecord(self)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 678, in __init__\n    |     self.__connect()\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 902, in __connect\n    |     with util.safe_reraise():\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__\n    |     raise exc_value.with_traceback(exc_tb)\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 898, in __connect\n    |     self.dbapi_connection = connection = pool._invoke_creator(self)\n    |                                          ^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/create.py", line 637, in connect\n    |     return dialect.connect(*cargs, **cparams)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 615, in connect\n    |     return self.loaded_dbapi.connect(*cargs, **cparams)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/psycopg2/__init__.py", line 122, in connect\n    |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    | sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: Connection refused\n    | \tIs the server running on that host and accepting TCP/IP connections?\n    | connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused\n    | \tIs the server running on that host and accepting TCP/IP connections?\n    | \n    | (Background on this error at: https://sqlalche.me/e/20/e3q8)\n    +------------------------------------\n'}, 'request': {'method': 'GET', 'url': 'http://localhost:8080/resumos?url=https%3A%2F%2Fwww.wikipedia.org%2Fteste', 'headers': {'host': 'localhost:8080', 'user-agent': 'insomnia/10.0.0', 'correlationid': '12345', 'accept': '*/*'}}}
2024-10-01 02:56:20,564 - app.exception.handler_excecao - ERROR - {'correlation_id': '12345', 'error': {'type': 'ExceptionGroup', 'message': 'unhandled errors in a TaskGroup (1 sub-exception)', 'traceback': 'Traceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 108, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/app/app/logging/logging_interceptor.py", line 17, in log_request\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 84, in call_next\n    raise app_exc\n  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File "/usr/local/lib/python3.11/site-packages/prometheus_fastapi_instrumentator/middleware.py", line 155, in __call__\n    raise exc\n  File "/usr/local/lib/python3.11/site-packages/prometheus_fastapi_instrumentator/middleware.py", line 153, in __call__\n    await self.app(scope, receive, send_wrapper)\n  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__\n    raise exc\n  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__\n    await self.app(scope, receive, sender)\n  File "/usr/local/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 21, in __call__\n    raise e\n  File "/usr/local/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__\n    await self.app(scope, receive, send)\n  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__\n    await route.handle(scope, receive, send)\n  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle\n    await self.app(scope, receive, send)\n  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 66, in app\n    response = await func(request)\n               ^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 237, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 163, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/app/app/router/resumo_router.py", line 13, in obter_resumo\n    return resumo_service.obter_resumo_existente(url)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/app/app/service/resumo_service.py", line 56, in obter_resumo_existente\n    resumo = self.resumo_repository.buscar_por_url(url)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/app/app/dataprovider/database/repository/resumo_repository.py", line 20, in buscar_por_url\n    return self.db.query(Resumo).filter(Resumo.url == url).first()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2743, in first\n    return self.limit(1)._iter().first()  # type: ignore\n           ^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2842, in _iter\n    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(\n                                                  ^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2262, in execute\n    return self._execute_internal(\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2134, in _execute_internal\n    conn = self._connection_for_bind(bind)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2001, in _connection_for_bind\n    return trans._connection_for_bind(engine, execution_options)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "<string>", line 2, in _connection_for_bind\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1126, in _connection_for_bind\n    conn = bind.connect()\n           ^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3264, in connect\n    return self._connection_cls(self)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 147, in __init__\n    Connection._handle_dbapi_exception_noconnection(\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2426, in _handle_dbapi_exception_noconnection\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 145, in __init__\n    self._dbapi_connection = engine.raw_connection()\n                             ^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3288, in raw_connection\n    return self.pool.connect()\n           ^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 452, in connect\n    return _ConnectionFairy._checkout(self)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 1267, in _checkout\n    fairy = _ConnectionRecord.checkout(pool)\n            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 716, in checkout\n    rec = pool._do_get()\n          ^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get\n    with util.safe_reraise():\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 167, in _do_get\n    return self._create_connection()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 393, in _create_connection\n    return _ConnectionRecord(self)\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 678, in __init__\n    self.__connect()\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 902, in __connect\n    with util.safe_reraise():\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 898, in __connect\n    self.dbapi_connection = connection = pool._invoke_creator(self)\n                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/create.py", line 637, in connect\n    return dialect.connect(*cargs, **cparams)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 615, in connect\n    return self.loaded_dbapi.connect(*cargs, **cparams)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/psycopg2/__init__.py", line 122, in connect\n    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nsqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: Connection refused\n\tIs the server running on that host and accepting TCP/IP connections?\nconnection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused\n\tIs the server running on that host and accepting TCP/IP connections?\n\n(Background on this error at: https://sqlalche.me/e/20/e3q8)\n\nDuring handling of the above exception, another exception occurred:\n\n  + Exception Group Traceback (most recent call last):\n  |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__\n  |     await self.app(scope, receive, _send)\n  |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 106, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |   File "/usr/local/lib/python3.11/site-packages/anyio/_backends/_asyncio.py", line 736, in __aexit__\n  |     raise BaseExceptionGroup(\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 145, in __init__\n    |     self._dbapi_connection = engine.raw_connection()\n    |                              ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3288, in raw_connection\n    |     return self.pool.connect()\n    |            ^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 452, in connect\n    |     return _ConnectionFairy._checkout(self)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 1267, in _checkout\n    |     fairy = _ConnectionRecord.checkout(pool)\n    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 716, in checkout\n    |     rec = pool._do_get()\n    |           ^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get\n    |     with util.safe_reraise():\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__\n    |     raise exc_value.with_traceback(exc_tb)\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 167, in _do_get\n    |     return self._create_connection()\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 393, in _create_connection\n    |     return _ConnectionRecord(self)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 678, in __init__\n    |     self.__connect()\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 902, in __connect\n    |     with util.safe_reraise():\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__\n    |     raise exc_value.with_traceback(exc_tb)\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 898, in __connect\n    |     self.dbapi_connection = connection = pool._invoke_creator(self)\n    |                                          ^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/create.py", line 637, in connect\n    |     return dialect.connect(*cargs, **cparams)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 615, in connect\n    |     return self.loaded_dbapi.connect(*cargs, **cparams)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/psycopg2/__init__.py", line 122, in connect\n    |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    | psycopg2.OperationalError: connection to server at "localhost" (::1), port 5432 failed: Connection refused\n    | \tIs the server running on that host and accepting TCP/IP connections?\n    | connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused\n    | \tIs the server running on that host and accepting TCP/IP connections?\n    | \n    | \n    | The above exception was the direct cause of the following exception:\n    | \n    | Traceback (most recent call last):\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 108, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/app/app/logging/logging_interceptor.py", line 17, in log_request\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 84, in call_next\n    |     raise app_exc\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 70, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File "/usr/local/lib/python3.11/site-packages/prometheus_fastapi_instrumentator/middleware.py", line 155, in __call__\n    |     raise exc\n    |   File "/usr/local/lib/python3.11/site-packages/prometheus_fastapi_instrumentator/middleware.py", line 153, in __call__\n    |     await self.app(scope, receive, send_wrapper)\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__\n    |     raise exc\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__\n    |     await self.app(scope, receive, sender)\n    |   File "/usr/local/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 21, in __call__\n    |     raise e\n    |   File "/usr/local/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__\n    |     await route.handle(scope, receive, send)\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle\n    |     await self.app(scope, receive, send)\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 66, in app\n    |     response = await func(request)\n    |                ^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 237, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 163, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/app/app/router/resumo_router.py", line 13, in obter_resumo\n    |     return resumo_service.obter_resumo_existente(url)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/app/app/service/resumo_service.py", line 56, in obter_resumo_existente\n    |     resumo = self.resumo_repository.buscar_por_url(url)\n    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/app/app/dataprovider/database/repository/resumo_repository.py", line 20, in buscar_por_url\n    |     return self.db.query(Resumo).filter(Resumo.url == url).first()\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2743, in first\n    |     return self.limit(1)._iter().first()  # type: ignore\n    |            ^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2842, in _iter\n    |     result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(\n    |                                                   ^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2262, in execute\n    |     return self._execute_internal(\n    |            ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2134, in _execute_internal\n    |     conn = self._connection_for_bind(bind)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2001, in _connection_for_bind\n    |     return trans._connection_for_bind(engine, execution_options)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "<string>", line 2, in _connection_for_bind\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go\n    |     ret_value = fn(self, *arg, **kw)\n    |                 ^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1126, in _connection_for_bind\n    |     conn = bind.connect()\n    |            ^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3264, in connect\n    |     return self._connection_cls(self)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 147, in __init__\n    |     Connection._handle_dbapi_exception_noconnection(\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2426, in _handle_dbapi_exception_noconnection\n    |     raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 145, in __init__\n    |     self._dbapi_connection = engine.raw_connection()\n    |                              ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3288, in raw_connection\n    |     return self.pool.connect()\n    |            ^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 452, in connect\n    |     return _ConnectionFairy._checkout(self)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 1267, in _checkout\n    |     fairy = _ConnectionRecord.checkout(pool)\n    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 716, in checkout\n    |     rec = pool._do_get()\n    |           ^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get\n    |     with util.safe_reraise():\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__\n    |     raise exc_value.with_traceback(exc_tb)\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 167, in _do_get\n    |     return self._create_connection()\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 393, in _create_connection\n    |     return _ConnectionRecord(self)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 678, in __init__\n    |     self.__connect()\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 902, in __connect\n    |     with util.safe_reraise():\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__\n    |     raise exc_value.with_traceback(exc_tb)\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 898, in __connect\n    |     self.dbapi_connection = connection = pool._invoke_creator(self)\n    |                                          ^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/create.py", line 637, in connect\n    |     return dialect.connect(*cargs, **cparams)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 615, in connect\n    |     return self.loaded_dbapi.connect(*cargs, **cparams)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/psycopg2/__init__.py", line 122, in connect\n    |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    | sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: Connection refused\n    | \tIs the server running on that host and accepting TCP/IP connections?\n    | connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused\n    | \tIs the server running on that host and accepting TCP/IP connections?\n    | \n    | (Background on this error at: https://sqlalche.me/e/20/e3q8)\n    +------------------------------------\n'}, 'request': {'method': 'GET', 'url': 'http://localhost:8080/resumos?url=https%3A%2F%2Fwww.wikipedia.org%2Fteste', 'headers': {'host': 'localhost:8080', 'user-agent': 'insomnia/10.0.0', 'correlationid': '12345', 'accept': '*/*'}}}
2024-10-01 02:56:25,312 - app.logging.logging_interceptor - INFO - 
2024-10-01 02:56:55,311 - app.logging.logging_interceptor - INFO - 
2024-10-01 02:57:11,173 - app.exception.handler_excecao - ERROR - {'correlation_id': '12345', 'error': {'type': 'ExceptionGroup', 'message': 'unhandled errors in a TaskGroup (1 sub-exception)', 'traceback': 'Traceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 108, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/app/app/logging/logging_interceptor.py", line 17, in log_request\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 84, in call_next\n    raise app_exc\n  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File "/usr/local/lib/python3.11/site-packages/prometheus_fastapi_instrumentator/middleware.py", line 155, in __call__\n    raise exc\n  File "/usr/local/lib/python3.11/site-packages/prometheus_fastapi_instrumentator/middleware.py", line 153, in __call__\n    await self.app(scope, receive, send_wrapper)\n  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__\n    raise exc\n  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__\n    await self.app(scope, receive, sender)\n  File "/usr/local/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 21, in __call__\n    raise e\n  File "/usr/local/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__\n    await self.app(scope, receive, send)\n  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__\n    await route.handle(scope, receive, send)\n  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle\n    await self.app(scope, receive, send)\n  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 66, in app\n    response = await func(request)\n               ^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 237, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 163, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/app/app/router/resumo_router.py", line 13, in obter_resumo\n    return resumo_service.obter_resumo_existente(url)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/app/app/service/resumo_service.py", line 56, in obter_resumo_existente\n    resumo = self.resumo_repository.buscar_por_url(url)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/app/app/dataprovider/database/repository/resumo_repository.py", line 20, in buscar_por_url\n    return self.db.query(Resumo).filter(Resumo.url == url).first()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2743, in first\n    return self.limit(1)._iter().first()  # type: ignore\n           ^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2842, in _iter\n    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(\n                                                  ^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2262, in execute\n    return self._execute_internal(\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2134, in _execute_internal\n    conn = self._connection_for_bind(bind)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2001, in _connection_for_bind\n    return trans._connection_for_bind(engine, execution_options)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "<string>", line 2, in _connection_for_bind\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1126, in _connection_for_bind\n    conn = bind.connect()\n           ^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3264, in connect\n    return self._connection_cls(self)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 147, in __init__\n    Connection._handle_dbapi_exception_noconnection(\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2426, in _handle_dbapi_exception_noconnection\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 145, in __init__\n    self._dbapi_connection = engine.raw_connection()\n                             ^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3288, in raw_connection\n    return self.pool.connect()\n           ^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 452, in connect\n    return _ConnectionFairy._checkout(self)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 1267, in _checkout\n    fairy = _ConnectionRecord.checkout(pool)\n            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 716, in checkout\n    rec = pool._do_get()\n          ^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get\n    with util.safe_reraise():\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 167, in _do_get\n    return self._create_connection()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 393, in _create_connection\n    return _ConnectionRecord(self)\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 678, in __init__\n    self.__connect()\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 902, in __connect\n    with util.safe_reraise():\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 898, in __connect\n    self.dbapi_connection = connection = pool._invoke_creator(self)\n                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/create.py", line 637, in connect\n    return dialect.connect(*cargs, **cparams)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 615, in connect\n    return self.loaded_dbapi.connect(*cargs, **cparams)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/psycopg2/__init__.py", line 122, in connect\n    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nsqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: Connection refused\n\tIs the server running on that host and accepting TCP/IP connections?\nconnection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused\n\tIs the server running on that host and accepting TCP/IP connections?\n\n(Background on this error at: https://sqlalche.me/e/20/e3q8)\n\nDuring handling of the above exception, another exception occurred:\n\n  + Exception Group Traceback (most recent call last):\n  |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__\n  |     await self.app(scope, receive, _send)\n  |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 106, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |   File "/usr/local/lib/python3.11/site-packages/anyio/_backends/_asyncio.py", line 736, in __aexit__\n  |     raise BaseExceptionGroup(\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 145, in __init__\n    |     self._dbapi_connection = engine.raw_connection()\n    |                              ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3288, in raw_connection\n    |     return self.pool.connect()\n    |            ^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 452, in connect\n    |     return _ConnectionFairy._checkout(self)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 1267, in _checkout\n    |     fairy = _ConnectionRecord.checkout(pool)\n    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 716, in checkout\n    |     rec = pool._do_get()\n    |           ^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get\n    |     with util.safe_reraise():\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__\n    |     raise exc_value.with_traceback(exc_tb)\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 167, in _do_get\n    |     return self._create_connection()\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 393, in _create_connection\n    |     return _ConnectionRecord(self)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 678, in __init__\n    |     self.__connect()\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 902, in __connect\n    |     with util.safe_reraise():\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__\n    |     raise exc_value.with_traceback(exc_tb)\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 898, in __connect\n    |     self.dbapi_connection = connection = pool._invoke_creator(self)\n    |                                          ^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/create.py", line 637, in connect\n    |     return dialect.connect(*cargs, **cparams)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 615, in connect\n    |     return self.loaded_dbapi.connect(*cargs, **cparams)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/psycopg2/__init__.py", line 122, in connect\n    |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    | psycopg2.OperationalError: connection to server at "localhost" (::1), port 5432 failed: Connection refused\n    | \tIs the server running on that host and accepting TCP/IP connections?\n    | connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused\n    | \tIs the server running on that host and accepting TCP/IP connections?\n    | \n    | \n    | The above exception was the direct cause of the following exception:\n    | \n    | Traceback (most recent call last):\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 108, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/app/app/logging/logging_interceptor.py", line 17, in log_request\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 84, in call_next\n    |     raise app_exc\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 70, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File "/usr/local/lib/python3.11/site-packages/prometheus_fastapi_instrumentator/middleware.py", line 155, in __call__\n    |     raise exc\n    |   File "/usr/local/lib/python3.11/site-packages/prometheus_fastapi_instrumentator/middleware.py", line 153, in __call__\n    |     await self.app(scope, receive, send_wrapper)\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__\n    |     raise exc\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__\n    |     await self.app(scope, receive, sender)\n    |   File "/usr/local/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 21, in __call__\n    |     raise e\n    |   File "/usr/local/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__\n    |     await route.handle(scope, receive, send)\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle\n    |     await self.app(scope, receive, send)\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 66, in app\n    |     response = await func(request)\n    |                ^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 237, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 163, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/app/app/router/resumo_router.py", line 13, in obter_resumo\n    |     return resumo_service.obter_resumo_existente(url)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/app/app/service/resumo_service.py", line 56, in obter_resumo_existente\n    |     resumo = self.resumo_repository.buscar_por_url(url)\n    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/app/app/dataprovider/database/repository/resumo_repository.py", line 20, in buscar_por_url\n    |     return self.db.query(Resumo).filter(Resumo.url == url).first()\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2743, in first\n    |     return self.limit(1)._iter().first()  # type: ignore\n    |            ^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2842, in _iter\n    |     result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(\n    |                                                   ^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2262, in execute\n    |     return self._execute_internal(\n    |            ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2134, in _execute_internal\n    |     conn = self._connection_for_bind(bind)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2001, in _connection_for_bind\n    |     return trans._connection_for_bind(engine, execution_options)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "<string>", line 2, in _connection_for_bind\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go\n    |     ret_value = fn(self, *arg, **kw)\n    |                 ^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1126, in _connection_for_bind\n    |     conn = bind.connect()\n    |            ^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3264, in connect\n    |     return self._connection_cls(self)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 147, in __init__\n    |     Connection._handle_dbapi_exception_noconnection(\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2426, in _handle_dbapi_exception_noconnection\n    |     raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 145, in __init__\n    |     self._dbapi_connection = engine.raw_connection()\n    |                              ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3288, in raw_connection\n    |     return self.pool.connect()\n    |            ^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 452, in connect\n    |     return _ConnectionFairy._checkout(self)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 1267, in _checkout\n    |     fairy = _ConnectionRecord.checkout(pool)\n    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 716, in checkout\n    |     rec = pool._do_get()\n    |           ^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get\n    |     with util.safe_reraise():\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__\n    |     raise exc_value.with_traceback(exc_tb)\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 167, in _do_get\n    |     return self._create_connection()\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 393, in _create_connection\n    |     return _ConnectionRecord(self)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 678, in __init__\n    |     self.__connect()\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 902, in __connect\n    |     with util.safe_reraise():\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__\n    |     raise exc_value.with_traceback(exc_tb)\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 898, in __connect\n    |     self.dbapi_connection = connection = pool._invoke_creator(self)\n    |                                          ^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/create.py", line 637, in connect\n    |     return dialect.connect(*cargs, **cparams)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 615, in connect\n    |     return self.loaded_dbapi.connect(*cargs, **cparams)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/psycopg2/__init__.py", line 122, in connect\n    |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    | sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: Connection refused\n    | \tIs the server running on that host and accepting TCP/IP connections?\n    | connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused\n    | \tIs the server running on that host and accepting TCP/IP connections?\n    | \n    | (Background on this error at: https://sqlalche.me/e/20/e3q8)\n    +------------------------------------\n'}, 'request': {'method': 'GET', 'url': 'http://localhost:8080/resumos?url=https%3A%2F%2Fwww.wikipedia.org%2Fteste', 'headers': {'host': 'localhost:8080', 'user-agent': 'insomnia/10.0.0', 'correlationid': '12345', 'accept': '*/*'}}}
2024-10-01 02:57:11,730 - app.exception.handler_excecao - ERROR - {'correlation_id': '12345', 'error': {'type': 'ExceptionGroup', 'message': 'unhandled errors in a TaskGroup (1 sub-exception)', 'traceback': 'Traceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 108, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/app/app/logging/logging_interceptor.py", line 17, in log_request\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 84, in call_next\n    raise app_exc\n  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File "/usr/local/lib/python3.11/site-packages/prometheus_fastapi_instrumentator/middleware.py", line 155, in __call__\n    raise exc\n  File "/usr/local/lib/python3.11/site-packages/prometheus_fastapi_instrumentator/middleware.py", line 153, in __call__\n    await self.app(scope, receive, send_wrapper)\n  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__\n    raise exc\n  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__\n    await self.app(scope, receive, sender)\n  File "/usr/local/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 21, in __call__\n    raise e\n  File "/usr/local/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__\n    await self.app(scope, receive, send)\n  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__\n    await route.handle(scope, receive, send)\n  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle\n    await self.app(scope, receive, send)\n  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 66, in app\n    response = await func(request)\n               ^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 237, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 163, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/app/app/router/resumo_router.py", line 13, in obter_resumo\n    return resumo_service.obter_resumo_existente(url)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/app/app/service/resumo_service.py", line 56, in obter_resumo_existente\n    resumo = self.resumo_repository.buscar_por_url(url)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/app/app/dataprovider/database/repository/resumo_repository.py", line 20, in buscar_por_url\n    return self.db.query(Resumo).filter(Resumo.url == url).first()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2743, in first\n    return self.limit(1)._iter().first()  # type: ignore\n           ^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2842, in _iter\n    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(\n                                                  ^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2262, in execute\n    return self._execute_internal(\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2134, in _execute_internal\n    conn = self._connection_for_bind(bind)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2001, in _connection_for_bind\n    return trans._connection_for_bind(engine, execution_options)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "<string>", line 2, in _connection_for_bind\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1126, in _connection_for_bind\n    conn = bind.connect()\n           ^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3264, in connect\n    return self._connection_cls(self)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 147, in __init__\n    Connection._handle_dbapi_exception_noconnection(\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2426, in _handle_dbapi_exception_noconnection\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 145, in __init__\n    self._dbapi_connection = engine.raw_connection()\n                             ^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3288, in raw_connection\n    return self.pool.connect()\n           ^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 452, in connect\n    return _ConnectionFairy._checkout(self)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 1267, in _checkout\n    fairy = _ConnectionRecord.checkout(pool)\n            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 716, in checkout\n    rec = pool._do_get()\n          ^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get\n    with util.safe_reraise():\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 167, in _do_get\n    return self._create_connection()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 393, in _create_connection\n    return _ConnectionRecord(self)\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 678, in __init__\n    self.__connect()\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 902, in __connect\n    with util.safe_reraise():\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 898, in __connect\n    self.dbapi_connection = connection = pool._invoke_creator(self)\n                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/create.py", line 637, in connect\n    return dialect.connect(*cargs, **cparams)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 615, in connect\n    return self.loaded_dbapi.connect(*cargs, **cparams)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/psycopg2/__init__.py", line 122, in connect\n    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nsqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: Connection refused\n\tIs the server running on that host and accepting TCP/IP connections?\nconnection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused\n\tIs the server running on that host and accepting TCP/IP connections?\n\n(Background on this error at: https://sqlalche.me/e/20/e3q8)\n\nDuring handling of the above exception, another exception occurred:\n\n  + Exception Group Traceback (most recent call last):\n  |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__\n  |     await self.app(scope, receive, _send)\n  |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 106, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |   File "/usr/local/lib/python3.11/site-packages/anyio/_backends/_asyncio.py", line 736, in __aexit__\n  |     raise BaseExceptionGroup(\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 145, in __init__\n    |     self._dbapi_connection = engine.raw_connection()\n    |                              ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3288, in raw_connection\n    |     return self.pool.connect()\n    |            ^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 452, in connect\n    |     return _ConnectionFairy._checkout(self)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 1267, in _checkout\n    |     fairy = _ConnectionRecord.checkout(pool)\n    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 716, in checkout\n    |     rec = pool._do_get()\n    |           ^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get\n    |     with util.safe_reraise():\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__\n    |     raise exc_value.with_traceback(exc_tb)\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 167, in _do_get\n    |     return self._create_connection()\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 393, in _create_connection\n    |     return _ConnectionRecord(self)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 678, in __init__\n    |     self.__connect()\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 902, in __connect\n    |     with util.safe_reraise():\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__\n    |     raise exc_value.with_traceback(exc_tb)\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 898, in __connect\n    |     self.dbapi_connection = connection = pool._invoke_creator(self)\n    |                                          ^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/create.py", line 637, in connect\n    |     return dialect.connect(*cargs, **cparams)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 615, in connect\n    |     return self.loaded_dbapi.connect(*cargs, **cparams)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/psycopg2/__init__.py", line 122, in connect\n    |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    | psycopg2.OperationalError: connection to server at "localhost" (::1), port 5432 failed: Connection refused\n    | \tIs the server running on that host and accepting TCP/IP connections?\n    | connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused\n    | \tIs the server running on that host and accepting TCP/IP connections?\n    | \n    | \n    | The above exception was the direct cause of the following exception:\n    | \n    | Traceback (most recent call last):\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 108, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/app/app/logging/logging_interceptor.py", line 17, in log_request\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 84, in call_next\n    |     raise app_exc\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 70, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File "/usr/local/lib/python3.11/site-packages/prometheus_fastapi_instrumentator/middleware.py", line 155, in __call__\n    |     raise exc\n    |   File "/usr/local/lib/python3.11/site-packages/prometheus_fastapi_instrumentator/middleware.py", line 153, in __call__\n    |     await self.app(scope, receive, send_wrapper)\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__\n    |     raise exc\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__\n    |     await self.app(scope, receive, sender)\n    |   File "/usr/local/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 21, in __call__\n    |     raise e\n    |   File "/usr/local/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__\n    |     await route.handle(scope, receive, send)\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle\n    |     await self.app(scope, receive, send)\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 66, in app\n    |     response = await func(request)\n    |                ^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 237, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 163, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/app/app/router/resumo_router.py", line 13, in obter_resumo\n    |     return resumo_service.obter_resumo_existente(url)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/app/app/service/resumo_service.py", line 56, in obter_resumo_existente\n    |     resumo = self.resumo_repository.buscar_por_url(url)\n    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/app/app/dataprovider/database/repository/resumo_repository.py", line 20, in buscar_por_url\n    |     return self.db.query(Resumo).filter(Resumo.url == url).first()\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2743, in first\n    |     return self.limit(1)._iter().first()  # type: ignore\n    |            ^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2842, in _iter\n    |     result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(\n    |                                                   ^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2262, in execute\n    |     return self._execute_internal(\n    |            ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2134, in _execute_internal\n    |     conn = self._connection_for_bind(bind)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2001, in _connection_for_bind\n    |     return trans._connection_for_bind(engine, execution_options)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "<string>", line 2, in _connection_for_bind\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go\n    |     ret_value = fn(self, *arg, **kw)\n    |                 ^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1126, in _connection_for_bind\n    |     conn = bind.connect()\n    |            ^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3264, in connect\n    |     return self._connection_cls(self)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 147, in __init__\n    |     Connection._handle_dbapi_exception_noconnection(\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2426, in _handle_dbapi_exception_noconnection\n    |     raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 145, in __init__\n    |     self._dbapi_connection = engine.raw_connection()\n    |                              ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3288, in raw_connection\n    |     return self.pool.connect()\n    |            ^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 452, in connect\n    |     return _ConnectionFairy._checkout(self)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 1267, in _checkout\n    |     fairy = _ConnectionRecord.checkout(pool)\n    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 716, in checkout\n    |     rec = pool._do_get()\n    |           ^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get\n    |     with util.safe_reraise():\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__\n    |     raise exc_value.with_traceback(exc_tb)\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 167, in _do_get\n    |     return self._create_connection()\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 393, in _create_connection\n    |     return _ConnectionRecord(self)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 678, in __init__\n    |     self.__connect()\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 902, in __connect\n    |     with util.safe_reraise():\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__\n    |     raise exc_value.with_traceback(exc_tb)\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 898, in __connect\n    |     self.dbapi_connection = connection = pool._invoke_creator(self)\n    |                                          ^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/create.py", line 637, in connect\n    |     return dialect.connect(*cargs, **cparams)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 615, in connect\n    |     return self.loaded_dbapi.connect(*cargs, **cparams)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/psycopg2/__init__.py", line 122, in connect\n    |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    | sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: Connection refused\n    | \tIs the server running on that host and accepting TCP/IP connections?\n    | connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused\n    | \tIs the server running on that host and accepting TCP/IP connections?\n    | \n    | (Background on this error at: https://sqlalche.me/e/20/e3q8)\n    +------------------------------------\n'}, 'request': {'method': 'GET', 'url': 'http://localhost:8080/resumos?url=https%3A%2F%2Fwww.wikipedia.org%2Fteste', 'headers': {'host': 'localhost:8080', 'user-agent': 'insomnia/10.0.0', 'correlationid': '12345', 'accept': '*/*'}}}
2024-10-01 02:57:12,149 - app.exception.handler_excecao - ERROR - {'correlation_id': '12345', 'error': {'type': 'ExceptionGroup', 'message': 'unhandled errors in a TaskGroup (1 sub-exception)', 'traceback': 'Traceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 108, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/app/app/logging/logging_interceptor.py", line 17, in log_request\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 84, in call_next\n    raise app_exc\n  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File "/usr/local/lib/python3.11/site-packages/prometheus_fastapi_instrumentator/middleware.py", line 155, in __call__\n    raise exc\n  File "/usr/local/lib/python3.11/site-packages/prometheus_fastapi_instrumentator/middleware.py", line 153, in __call__\n    await self.app(scope, receive, send_wrapper)\n  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__\n    raise exc\n  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__\n    await self.app(scope, receive, sender)\n  File "/usr/local/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 21, in __call__\n    raise e\n  File "/usr/local/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__\n    await self.app(scope, receive, send)\n  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__\n    await route.handle(scope, receive, send)\n  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle\n    await self.app(scope, receive, send)\n  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 66, in app\n    response = await func(request)\n               ^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 237, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 163, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/app/app/router/resumo_router.py", line 13, in obter_resumo\n    return resumo_service.obter_resumo_existente(url)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/app/app/service/resumo_service.py", line 56, in obter_resumo_existente\n    resumo = self.resumo_repository.buscar_por_url(url)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/app/app/dataprovider/database/repository/resumo_repository.py", line 20, in buscar_por_url\n    return self.db.query(Resumo).filter(Resumo.url == url).first()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2743, in first\n    return self.limit(1)._iter().first()  # type: ignore\n           ^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2842, in _iter\n    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(\n                                                  ^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2262, in execute\n    return self._execute_internal(\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2134, in _execute_internal\n    conn = self._connection_for_bind(bind)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2001, in _connection_for_bind\n    return trans._connection_for_bind(engine, execution_options)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "<string>", line 2, in _connection_for_bind\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1126, in _connection_for_bind\n    conn = bind.connect()\n           ^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3264, in connect\n    return self._connection_cls(self)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 147, in __init__\n    Connection._handle_dbapi_exception_noconnection(\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2426, in _handle_dbapi_exception_noconnection\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 145, in __init__\n    self._dbapi_connection = engine.raw_connection()\n                             ^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3288, in raw_connection\n    return self.pool.connect()\n           ^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 452, in connect\n    return _ConnectionFairy._checkout(self)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 1267, in _checkout\n    fairy = _ConnectionRecord.checkout(pool)\n            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 716, in checkout\n    rec = pool._do_get()\n          ^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get\n    with util.safe_reraise():\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 167, in _do_get\n    return self._create_connection()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 393, in _create_connection\n    return _ConnectionRecord(self)\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 678, in __init__\n    self.__connect()\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 902, in __connect\n    with util.safe_reraise():\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 898, in __connect\n    self.dbapi_connection = connection = pool._invoke_creator(self)\n                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/create.py", line 637, in connect\n    return dialect.connect(*cargs, **cparams)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 615, in connect\n    return self.loaded_dbapi.connect(*cargs, **cparams)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/psycopg2/__init__.py", line 122, in connect\n    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nsqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: Connection refused\n\tIs the server running on that host and accepting TCP/IP connections?\nconnection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused\n\tIs the server running on that host and accepting TCP/IP connections?\n\n(Background on this error at: https://sqlalche.me/e/20/e3q8)\n\nDuring handling of the above exception, another exception occurred:\n\n  + Exception Group Traceback (most recent call last):\n  |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__\n  |     await self.app(scope, receive, _send)\n  |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 106, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |   File "/usr/local/lib/python3.11/site-packages/anyio/_backends/_asyncio.py", line 736, in __aexit__\n  |     raise BaseExceptionGroup(\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 145, in __init__\n    |     self._dbapi_connection = engine.raw_connection()\n    |                              ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3288, in raw_connection\n    |     return self.pool.connect()\n    |            ^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 452, in connect\n    |     return _ConnectionFairy._checkout(self)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 1267, in _checkout\n    |     fairy = _ConnectionRecord.checkout(pool)\n    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 716, in checkout\n    |     rec = pool._do_get()\n    |           ^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get\n    |     with util.safe_reraise():\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__\n    |     raise exc_value.with_traceback(exc_tb)\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 167, in _do_get\n    |     return self._create_connection()\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 393, in _create_connection\n    |     return _ConnectionRecord(self)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 678, in __init__\n    |     self.__connect()\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 902, in __connect\n    |     with util.safe_reraise():\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__\n    |     raise exc_value.with_traceback(exc_tb)\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 898, in __connect\n    |     self.dbapi_connection = connection = pool._invoke_creator(self)\n    |                                          ^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/create.py", line 637, in connect\n    |     return dialect.connect(*cargs, **cparams)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 615, in connect\n    |     return self.loaded_dbapi.connect(*cargs, **cparams)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/psycopg2/__init__.py", line 122, in connect\n    |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    | psycopg2.OperationalError: connection to server at "localhost" (::1), port 5432 failed: Connection refused\n    | \tIs the server running on that host and accepting TCP/IP connections?\n    | connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused\n    | \tIs the server running on that host and accepting TCP/IP connections?\n    | \n    | \n    | The above exception was the direct cause of the following exception:\n    | \n    | Traceback (most recent call last):\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 108, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/app/app/logging/logging_interceptor.py", line 17, in log_request\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 84, in call_next\n    |     raise app_exc\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 70, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File "/usr/local/lib/python3.11/site-packages/prometheus_fastapi_instrumentator/middleware.py", line 155, in __call__\n    |     raise exc\n    |   File "/usr/local/lib/python3.11/site-packages/prometheus_fastapi_instrumentator/middleware.py", line 153, in __call__\n    |     await self.app(scope, receive, send_wrapper)\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__\n    |     raise exc\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__\n    |     await self.app(scope, receive, sender)\n    |   File "/usr/local/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 21, in __call__\n    |     raise e\n    |   File "/usr/local/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__\n    |     await route.handle(scope, receive, send)\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle\n    |     await self.app(scope, receive, send)\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 66, in app\n    |     response = await func(request)\n    |                ^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 237, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 163, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/app/app/router/resumo_router.py", line 13, in obter_resumo\n    |     return resumo_service.obter_resumo_existente(url)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/app/app/service/resumo_service.py", line 56, in obter_resumo_existente\n    |     resumo = self.resumo_repository.buscar_por_url(url)\n    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/app/app/dataprovider/database/repository/resumo_repository.py", line 20, in buscar_por_url\n    |     return self.db.query(Resumo).filter(Resumo.url == url).first()\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2743, in first\n    |     return self.limit(1)._iter().first()  # type: ignore\n    |            ^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2842, in _iter\n    |     result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(\n    |                                                   ^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2262, in execute\n    |     return self._execute_internal(\n    |            ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2134, in _execute_internal\n    |     conn = self._connection_for_bind(bind)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2001, in _connection_for_bind\n    |     return trans._connection_for_bind(engine, execution_options)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "<string>", line 2, in _connection_for_bind\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go\n    |     ret_value = fn(self, *arg, **kw)\n    |                 ^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1126, in _connection_for_bind\n    |     conn = bind.connect()\n    |            ^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3264, in connect\n    |     return self._connection_cls(self)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 147, in __init__\n    |     Connection._handle_dbapi_exception_noconnection(\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2426, in _handle_dbapi_exception_noconnection\n    |     raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 145, in __init__\n    |     self._dbapi_connection = engine.raw_connection()\n    |                              ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3288, in raw_connection\n    |     return self.pool.connect()\n    |            ^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 452, in connect\n    |     return _ConnectionFairy._checkout(self)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 1267, in _checkout\n    |     fairy = _ConnectionRecord.checkout(pool)\n    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 716, in checkout\n    |     rec = pool._do_get()\n    |           ^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get\n    |     with util.safe_reraise():\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__\n    |     raise exc_value.with_traceback(exc_tb)\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 167, in _do_get\n    |     return self._create_connection()\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 393, in _create_connection\n    |     return _ConnectionRecord(self)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 678, in __init__\n    |     self.__connect()\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 902, in __connect\n    |     with util.safe_reraise():\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__\n    |     raise exc_value.with_traceback(exc_tb)\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 898, in __connect\n    |     self.dbapi_connection = connection = pool._invoke_creator(self)\n    |                                          ^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/create.py", line 637, in connect\n    |     return dialect.connect(*cargs, **cparams)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 615, in connect\n    |     return self.loaded_dbapi.connect(*cargs, **cparams)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/psycopg2/__init__.py", line 122, in connect\n    |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    | sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: Connection refused\n    | \tIs the server running on that host and accepting TCP/IP connections?\n    | connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused\n    | \tIs the server running on that host and accepting TCP/IP connections?\n    | \n    | (Background on this error at: https://sqlalche.me/e/20/e3q8)\n    +------------------------------------\n'}, 'request': {'method': 'GET', 'url': 'http://localhost:8080/resumos?url=https%3A%2F%2Fwww.wikipedia.org%2Fteste', 'headers': {'host': 'localhost:8080', 'user-agent': 'insomnia/10.0.0', 'correlationid': '12345', 'accept': '*/*'}}}
2024-10-01 02:57:12,508 - app.exception.handler_excecao - ERROR - {'correlation_id': '12345', 'error': {'type': 'ExceptionGroup', 'message': 'unhandled errors in a TaskGroup (1 sub-exception)', 'traceback': 'Traceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 108, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/app/app/logging/logging_interceptor.py", line 17, in log_request\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 84, in call_next\n    raise app_exc\n  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File "/usr/local/lib/python3.11/site-packages/prometheus_fastapi_instrumentator/middleware.py", line 155, in __call__\n    raise exc\n  File "/usr/local/lib/python3.11/site-packages/prometheus_fastapi_instrumentator/middleware.py", line 153, in __call__\n    await self.app(scope, receive, send_wrapper)\n  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__\n    raise exc\n  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__\n    await self.app(scope, receive, sender)\n  File "/usr/local/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 21, in __call__\n    raise e\n  File "/usr/local/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__\n    await self.app(scope, receive, send)\n  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__\n    await route.handle(scope, receive, send)\n  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle\n    await self.app(scope, receive, send)\n  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 66, in app\n    response = await func(request)\n               ^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 237, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 163, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/app/app/router/resumo_router.py", line 13, in obter_resumo\n    return resumo_service.obter_resumo_existente(url)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/app/app/service/resumo_service.py", line 56, in obter_resumo_existente\n    resumo = self.resumo_repository.buscar_por_url(url)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/app/app/dataprovider/database/repository/resumo_repository.py", line 20, in buscar_por_url\n    return self.db.query(Resumo).filter(Resumo.url == url).first()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2743, in first\n    return self.limit(1)._iter().first()  # type: ignore\n           ^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2842, in _iter\n    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(\n                                                  ^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2262, in execute\n    return self._execute_internal(\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2134, in _execute_internal\n    conn = self._connection_for_bind(bind)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2001, in _connection_for_bind\n    return trans._connection_for_bind(engine, execution_options)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "<string>", line 2, in _connection_for_bind\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1126, in _connection_for_bind\n    conn = bind.connect()\n           ^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3264, in connect\n    return self._connection_cls(self)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 147, in __init__\n    Connection._handle_dbapi_exception_noconnection(\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2426, in _handle_dbapi_exception_noconnection\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 145, in __init__\n    self._dbapi_connection = engine.raw_connection()\n                             ^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3288, in raw_connection\n    return self.pool.connect()\n           ^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 452, in connect\n    return _ConnectionFairy._checkout(self)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 1267, in _checkout\n    fairy = _ConnectionRecord.checkout(pool)\n            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 716, in checkout\n    rec = pool._do_get()\n          ^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get\n    with util.safe_reraise():\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 167, in _do_get\n    return self._create_connection()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 393, in _create_connection\n    return _ConnectionRecord(self)\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 678, in __init__\n    self.__connect()\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 902, in __connect\n    with util.safe_reraise():\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 898, in __connect\n    self.dbapi_connection = connection = pool._invoke_creator(self)\n                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/create.py", line 637, in connect\n    return dialect.connect(*cargs, **cparams)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 615, in connect\n    return self.loaded_dbapi.connect(*cargs, **cparams)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/psycopg2/__init__.py", line 122, in connect\n    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nsqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: Connection refused\n\tIs the server running on that host and accepting TCP/IP connections?\nconnection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused\n\tIs the server running on that host and accepting TCP/IP connections?\n\n(Background on this error at: https://sqlalche.me/e/20/e3q8)\n\nDuring handling of the above exception, another exception occurred:\n\n  + Exception Group Traceback (most recent call last):\n  |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__\n  |     await self.app(scope, receive, _send)\n  |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 106, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |   File "/usr/local/lib/python3.11/site-packages/anyio/_backends/_asyncio.py", line 736, in __aexit__\n  |     raise BaseExceptionGroup(\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 145, in __init__\n    |     self._dbapi_connection = engine.raw_connection()\n    |                              ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3288, in raw_connection\n    |     return self.pool.connect()\n    |            ^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 452, in connect\n    |     return _ConnectionFairy._checkout(self)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 1267, in _checkout\n    |     fairy = _ConnectionRecord.checkout(pool)\n    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 716, in checkout\n    |     rec = pool._do_get()\n    |           ^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get\n    |     with util.safe_reraise():\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__\n    |     raise exc_value.with_traceback(exc_tb)\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 167, in _do_get\n    |     return self._create_connection()\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 393, in _create_connection\n    |     return _ConnectionRecord(self)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 678, in __init__\n    |     self.__connect()\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 902, in __connect\n    |     with util.safe_reraise():\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__\n    |     raise exc_value.with_traceback(exc_tb)\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 898, in __connect\n    |     self.dbapi_connection = connection = pool._invoke_creator(self)\n    |                                          ^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/create.py", line 637, in connect\n    |     return dialect.connect(*cargs, **cparams)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 615, in connect\n    |     return self.loaded_dbapi.connect(*cargs, **cparams)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/psycopg2/__init__.py", line 122, in connect\n    |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    | psycopg2.OperationalError: connection to server at "localhost" (::1), port 5432 failed: Connection refused\n    | \tIs the server running on that host and accepting TCP/IP connections?\n    | connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused\n    | \tIs the server running on that host and accepting TCP/IP connections?\n    | \n    | \n    | The above exception was the direct cause of the following exception:\n    | \n    | Traceback (most recent call last):\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 108, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/app/app/logging/logging_interceptor.py", line 17, in log_request\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 84, in call_next\n    |     raise app_exc\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 70, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File "/usr/local/lib/python3.11/site-packages/prometheus_fastapi_instrumentator/middleware.py", line 155, in __call__\n    |     raise exc\n    |   File "/usr/local/lib/python3.11/site-packages/prometheus_fastapi_instrumentator/middleware.py", line 153, in __call__\n    |     await self.app(scope, receive, send_wrapper)\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__\n    |     raise exc\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__\n    |     await self.app(scope, receive, sender)\n    |   File "/usr/local/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 21, in __call__\n    |     raise e\n    |   File "/usr/local/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__\n    |     await route.handle(scope, receive, send)\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle\n    |     await self.app(scope, receive, send)\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 66, in app\n    |     response = await func(request)\n    |                ^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 237, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 163, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/app/app/router/resumo_router.py", line 13, in obter_resumo\n    |     return resumo_service.obter_resumo_existente(url)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/app/app/service/resumo_service.py", line 56, in obter_resumo_existente\n    |     resumo = self.resumo_repository.buscar_por_url(url)\n    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/app/app/dataprovider/database/repository/resumo_repository.py", line 20, in buscar_por_url\n    |     return self.db.query(Resumo).filter(Resumo.url == url).first()\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2743, in first\n    |     return self.limit(1)._iter().first()  # type: ignore\n    |            ^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2842, in _iter\n    |     result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(\n    |                                                   ^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2262, in execute\n    |     return self._execute_internal(\n    |            ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2134, in _execute_internal\n    |     conn = self._connection_for_bind(bind)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2001, in _connection_for_bind\n    |     return trans._connection_for_bind(engine, execution_options)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "<string>", line 2, in _connection_for_bind\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go\n    |     ret_value = fn(self, *arg, **kw)\n    |                 ^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1126, in _connection_for_bind\n    |     conn = bind.connect()\n    |            ^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3264, in connect\n    |     return self._connection_cls(self)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 147, in __init__\n    |     Connection._handle_dbapi_exception_noconnection(\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2426, in _handle_dbapi_exception_noconnection\n    |     raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 145, in __init__\n    |     self._dbapi_connection = engine.raw_connection()\n    |                              ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3288, in raw_connection\n    |     return self.pool.connect()\n    |            ^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 452, in connect\n    |     return _ConnectionFairy._checkout(self)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 1267, in _checkout\n    |     fairy = _ConnectionRecord.checkout(pool)\n    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 716, in checkout\n    |     rec = pool._do_get()\n    |           ^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get\n    |     with util.safe_reraise():\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__\n    |     raise exc_value.with_traceback(exc_tb)\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 167, in _do_get\n    |     return self._create_connection()\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 393, in _create_connection\n    |     return _ConnectionRecord(self)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 678, in __init__\n    |     self.__connect()\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 902, in __connect\n    |     with util.safe_reraise():\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__\n    |     raise exc_value.with_traceback(exc_tb)\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 898, in __connect\n    |     self.dbapi_connection = connection = pool._invoke_creator(self)\n    |                                          ^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/create.py", line 637, in connect\n    |     return dialect.connect(*cargs, **cparams)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 615, in connect\n    |     return self.loaded_dbapi.connect(*cargs, **cparams)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/psycopg2/__init__.py", line 122, in connect\n    |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    | sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: Connection refused\n    | \tIs the server running on that host and accepting TCP/IP connections?\n    | connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused\n    | \tIs the server running on that host and accepting TCP/IP connections?\n    | \n    | (Background on this error at: https://sqlalche.me/e/20/e3q8)\n    +------------------------------------\n'}, 'request': {'method': 'GET', 'url': 'http://localhost:8080/resumos?url=https%3A%2F%2Fwww.wikipedia.org%2Fteste', 'headers': {'host': 'localhost:8080', 'user-agent': 'insomnia/10.0.0', 'correlationid': '12345', 'accept': '*/*'}}}
2024-10-01 02:57:12,838 - app.exception.handler_excecao - ERROR - {'correlation_id': '12345', 'error': {'type': 'ExceptionGroup', 'message': 'unhandled errors in a TaskGroup (1 sub-exception)', 'traceback': 'Traceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 108, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/app/app/logging/logging_interceptor.py", line 17, in log_request\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 84, in call_next\n    raise app_exc\n  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File "/usr/local/lib/python3.11/site-packages/prometheus_fastapi_instrumentator/middleware.py", line 155, in __call__\n    raise exc\n  File "/usr/local/lib/python3.11/site-packages/prometheus_fastapi_instrumentator/middleware.py", line 153, in __call__\n    await self.app(scope, receive, send_wrapper)\n  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__\n    raise exc\n  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__\n    await self.app(scope, receive, sender)\n  File "/usr/local/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 21, in __call__\n    raise e\n  File "/usr/local/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__\n    await self.app(scope, receive, send)\n  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__\n    await route.handle(scope, receive, send)\n  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle\n    await self.app(scope, receive, send)\n  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 66, in app\n    response = await func(request)\n               ^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 237, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 163, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/app/app/router/resumo_router.py", line 13, in obter_resumo\n    return resumo_service.obter_resumo_existente(url)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/app/app/service/resumo_service.py", line 56, in obter_resumo_existente\n    resumo = self.resumo_repository.buscar_por_url(url)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/app/app/dataprovider/database/repository/resumo_repository.py", line 20, in buscar_por_url\n    return self.db.query(Resumo).filter(Resumo.url == url).first()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2743, in first\n    return self.limit(1)._iter().first()  # type: ignore\n           ^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2842, in _iter\n    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(\n                                                  ^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2262, in execute\n    return self._execute_internal(\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2134, in _execute_internal\n    conn = self._connection_for_bind(bind)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2001, in _connection_for_bind\n    return trans._connection_for_bind(engine, execution_options)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "<string>", line 2, in _connection_for_bind\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1126, in _connection_for_bind\n    conn = bind.connect()\n           ^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3264, in connect\n    return self._connection_cls(self)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 147, in __init__\n    Connection._handle_dbapi_exception_noconnection(\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2426, in _handle_dbapi_exception_noconnection\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 145, in __init__\n    self._dbapi_connection = engine.raw_connection()\n                             ^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3288, in raw_connection\n    return self.pool.connect()\n           ^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 452, in connect\n    return _ConnectionFairy._checkout(self)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 1267, in _checkout\n    fairy = _ConnectionRecord.checkout(pool)\n            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 716, in checkout\n    rec = pool._do_get()\n          ^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get\n    with util.safe_reraise():\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 167, in _do_get\n    return self._create_connection()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 393, in _create_connection\n    return _ConnectionRecord(self)\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 678, in __init__\n    self.__connect()\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 902, in __connect\n    with util.safe_reraise():\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 898, in __connect\n    self.dbapi_connection = connection = pool._invoke_creator(self)\n                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/create.py", line 637, in connect\n    return dialect.connect(*cargs, **cparams)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 615, in connect\n    return self.loaded_dbapi.connect(*cargs, **cparams)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/psycopg2/__init__.py", line 122, in connect\n    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nsqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: Connection refused\n\tIs the server running on that host and accepting TCP/IP connections?\nconnection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused\n\tIs the server running on that host and accepting TCP/IP connections?\n\n(Background on this error at: https://sqlalche.me/e/20/e3q8)\n\nDuring handling of the above exception, another exception occurred:\n\n  + Exception Group Traceback (most recent call last):\n  |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__\n  |     await self.app(scope, receive, _send)\n  |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 106, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |   File "/usr/local/lib/python3.11/site-packages/anyio/_backends/_asyncio.py", line 736, in __aexit__\n  |     raise BaseExceptionGroup(\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 145, in __init__\n    |     self._dbapi_connection = engine.raw_connection()\n    |                              ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3288, in raw_connection\n    |     return self.pool.connect()\n    |            ^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 452, in connect\n    |     return _ConnectionFairy._checkout(self)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 1267, in _checkout\n    |     fairy = _ConnectionRecord.checkout(pool)\n    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 716, in checkout\n    |     rec = pool._do_get()\n    |           ^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get\n    |     with util.safe_reraise():\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__\n    |     raise exc_value.with_traceback(exc_tb)\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 167, in _do_get\n    |     return self._create_connection()\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 393, in _create_connection\n    |     return _ConnectionRecord(self)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 678, in __init__\n    |     self.__connect()\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 902, in __connect\n    |     with util.safe_reraise():\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__\n    |     raise exc_value.with_traceback(exc_tb)\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 898, in __connect\n    |     self.dbapi_connection = connection = pool._invoke_creator(self)\n    |                                          ^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/create.py", line 637, in connect\n    |     return dialect.connect(*cargs, **cparams)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 615, in connect\n    |     return self.loaded_dbapi.connect(*cargs, **cparams)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/psycopg2/__init__.py", line 122, in connect\n    |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    | psycopg2.OperationalError: connection to server at "localhost" (::1), port 5432 failed: Connection refused\n    | \tIs the server running on that host and accepting TCP/IP connections?\n    | connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused\n    | \tIs the server running on that host and accepting TCP/IP connections?\n    | \n    | \n    | The above exception was the direct cause of the following exception:\n    | \n    | Traceback (most recent call last):\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 108, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/app/app/logging/logging_interceptor.py", line 17, in log_request\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 84, in call_next\n    |     raise app_exc\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 70, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File "/usr/local/lib/python3.11/site-packages/prometheus_fastapi_instrumentator/middleware.py", line 155, in __call__\n    |     raise exc\n    |   File "/usr/local/lib/python3.11/site-packages/prometheus_fastapi_instrumentator/middleware.py", line 153, in __call__\n    |     await self.app(scope, receive, send_wrapper)\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__\n    |     raise exc\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__\n    |     await self.app(scope, receive, sender)\n    |   File "/usr/local/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 21, in __call__\n    |     raise e\n    |   File "/usr/local/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__\n    |     await route.handle(scope, receive, send)\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle\n    |     await self.app(scope, receive, send)\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 66, in app\n    |     response = await func(request)\n    |                ^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 237, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 163, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/app/app/router/resumo_router.py", line 13, in obter_resumo\n    |     return resumo_service.obter_resumo_existente(url)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/app/app/service/resumo_service.py", line 56, in obter_resumo_existente\n    |     resumo = self.resumo_repository.buscar_por_url(url)\n    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/app/app/dataprovider/database/repository/resumo_repository.py", line 20, in buscar_por_url\n    |     return self.db.query(Resumo).filter(Resumo.url == url).first()\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2743, in first\n    |     return self.limit(1)._iter().first()  # type: ignore\n    |            ^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2842, in _iter\n    |     result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(\n    |                                                   ^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2262, in execute\n    |     return self._execute_internal(\n    |            ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2134, in _execute_internal\n    |     conn = self._connection_for_bind(bind)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2001, in _connection_for_bind\n    |     return trans._connection_for_bind(engine, execution_options)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "<string>", line 2, in _connection_for_bind\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go\n    |     ret_value = fn(self, *arg, **kw)\n    |                 ^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1126, in _connection_for_bind\n    |     conn = bind.connect()\n    |            ^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3264, in connect\n    |     return self._connection_cls(self)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 147, in __init__\n    |     Connection._handle_dbapi_exception_noconnection(\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2426, in _handle_dbapi_exception_noconnection\n    |     raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 145, in __init__\n    |     self._dbapi_connection = engine.raw_connection()\n    |                              ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3288, in raw_connection\n    |     return self.pool.connect()\n    |            ^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 452, in connect\n    |     return _ConnectionFairy._checkout(self)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 1267, in _checkout\n    |     fairy = _ConnectionRecord.checkout(pool)\n    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 716, in checkout\n    |     rec = pool._do_get()\n    |           ^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get\n    |     with util.safe_reraise():\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__\n    |     raise exc_value.with_traceback(exc_tb)\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 167, in _do_get\n    |     return self._create_connection()\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 393, in _create_connection\n    |     return _ConnectionRecord(self)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 678, in __init__\n    |     self.__connect()\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 902, in __connect\n    |     with util.safe_reraise():\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__\n    |     raise exc_value.with_traceback(exc_tb)\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 898, in __connect\n    |     self.dbapi_connection = connection = pool._invoke_creator(self)\n    |                                          ^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/create.py", line 637, in connect\n    |     return dialect.connect(*cargs, **cparams)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 615, in connect\n    |     return self.loaded_dbapi.connect(*cargs, **cparams)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/psycopg2/__init__.py", line 122, in connect\n    |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    | sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: Connection refused\n    | \tIs the server running on that host and accepting TCP/IP connections?\n    | connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused\n    | \tIs the server running on that host and accepting TCP/IP connections?\n    | \n    | (Background on this error at: https://sqlalche.me/e/20/e3q8)\n    +------------------------------------\n'}, 'request': {'method': 'GET', 'url': 'http://localhost:8080/resumos?url=https%3A%2F%2Fwww.wikipedia.org%2Fteste', 'headers': {'host': 'localhost:8080', 'user-agent': 'insomnia/10.0.0', 'correlationid': '12345', 'accept': '*/*'}}}
2024-10-01 02:57:13,058 - app.exception.handler_excecao - ERROR - {'correlation_id': '12345', 'error': {'type': 'ExceptionGroup', 'message': 'unhandled errors in a TaskGroup (1 sub-exception)', 'traceback': 'Traceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 108, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/app/app/logging/logging_interceptor.py", line 17, in log_request\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 84, in call_next\n    raise app_exc\n  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File "/usr/local/lib/python3.11/site-packages/prometheus_fastapi_instrumentator/middleware.py", line 155, in __call__\n    raise exc\n  File "/usr/local/lib/python3.11/site-packages/prometheus_fastapi_instrumentator/middleware.py", line 153, in __call__\n    await self.app(scope, receive, send_wrapper)\n  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__\n    raise exc\n  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__\n    await self.app(scope, receive, sender)\n  File "/usr/local/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 21, in __call__\n    raise e\n  File "/usr/local/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__\n    await self.app(scope, receive, send)\n  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__\n    await route.handle(scope, receive, send)\n  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle\n    await self.app(scope, receive, send)\n  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 66, in app\n    response = await func(request)\n               ^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 237, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 163, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/app/app/router/resumo_router.py", line 13, in obter_resumo\n    return resumo_service.obter_resumo_existente(url)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/app/app/service/resumo_service.py", line 56, in obter_resumo_existente\n    resumo = self.resumo_repository.buscar_por_url(url)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/app/app/dataprovider/database/repository/resumo_repository.py", line 20, in buscar_por_url\n    return self.db.query(Resumo).filter(Resumo.url == url).first()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2743, in first\n    return self.limit(1)._iter().first()  # type: ignore\n           ^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2842, in _iter\n    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(\n                                                  ^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2262, in execute\n    return self._execute_internal(\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2134, in _execute_internal\n    conn = self._connection_for_bind(bind)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2001, in _connection_for_bind\n    return trans._connection_for_bind(engine, execution_options)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "<string>", line 2, in _connection_for_bind\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1126, in _connection_for_bind\n    conn = bind.connect()\n           ^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3264, in connect\n    return self._connection_cls(self)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 147, in __init__\n    Connection._handle_dbapi_exception_noconnection(\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2426, in _handle_dbapi_exception_noconnection\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 145, in __init__\n    self._dbapi_connection = engine.raw_connection()\n                             ^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3288, in raw_connection\n    return self.pool.connect()\n           ^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 452, in connect\n    return _ConnectionFairy._checkout(self)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 1267, in _checkout\n    fairy = _ConnectionRecord.checkout(pool)\n            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 716, in checkout\n    rec = pool._do_get()\n          ^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get\n    with util.safe_reraise():\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 167, in _do_get\n    return self._create_connection()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 393, in _create_connection\n    return _ConnectionRecord(self)\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 678, in __init__\n    self.__connect()\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 902, in __connect\n    with util.safe_reraise():\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 898, in __connect\n    self.dbapi_connection = connection = pool._invoke_creator(self)\n                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/create.py", line 637, in connect\n    return dialect.connect(*cargs, **cparams)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 615, in connect\n    return self.loaded_dbapi.connect(*cargs, **cparams)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/psycopg2/__init__.py", line 122, in connect\n    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nsqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: Connection refused\n\tIs the server running on that host and accepting TCP/IP connections?\nconnection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused\n\tIs the server running on that host and accepting TCP/IP connections?\n\n(Background on this error at: https://sqlalche.me/e/20/e3q8)\n\nDuring handling of the above exception, another exception occurred:\n\n  + Exception Group Traceback (most recent call last):\n  |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__\n  |     await self.app(scope, receive, _send)\n  |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 106, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |   File "/usr/local/lib/python3.11/site-packages/anyio/_backends/_asyncio.py", line 736, in __aexit__\n  |     raise BaseExceptionGroup(\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 145, in __init__\n    |     self._dbapi_connection = engine.raw_connection()\n    |                              ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3288, in raw_connection\n    |     return self.pool.connect()\n    |            ^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 452, in connect\n    |     return _ConnectionFairy._checkout(self)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 1267, in _checkout\n    |     fairy = _ConnectionRecord.checkout(pool)\n    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 716, in checkout\n    |     rec = pool._do_get()\n    |           ^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get\n    |     with util.safe_reraise():\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__\n    |     raise exc_value.with_traceback(exc_tb)\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 167, in _do_get\n    |     return self._create_connection()\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 393, in _create_connection\n    |     return _ConnectionRecord(self)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 678, in __init__\n    |     self.__connect()\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 902, in __connect\n    |     with util.safe_reraise():\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__\n    |     raise exc_value.with_traceback(exc_tb)\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 898, in __connect\n    |     self.dbapi_connection = connection = pool._invoke_creator(self)\n    |                                          ^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/create.py", line 637, in connect\n    |     return dialect.connect(*cargs, **cparams)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 615, in connect\n    |     return self.loaded_dbapi.connect(*cargs, **cparams)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/psycopg2/__init__.py", line 122, in connect\n    |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    | psycopg2.OperationalError: connection to server at "localhost" (::1), port 5432 failed: Connection refused\n    | \tIs the server running on that host and accepting TCP/IP connections?\n    | connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused\n    | \tIs the server running on that host and accepting TCP/IP connections?\n    | \n    | \n    | The above exception was the direct cause of the following exception:\n    | \n    | Traceback (most recent call last):\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 108, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/app/app/logging/logging_interceptor.py", line 17, in log_request\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 84, in call_next\n    |     raise app_exc\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 70, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File "/usr/local/lib/python3.11/site-packages/prometheus_fastapi_instrumentator/middleware.py", line 155, in __call__\n    |     raise exc\n    |   File "/usr/local/lib/python3.11/site-packages/prometheus_fastapi_instrumentator/middleware.py", line 153, in __call__\n    |     await self.app(scope, receive, send_wrapper)\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__\n    |     raise exc\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__\n    |     await self.app(scope, receive, sender)\n    |   File "/usr/local/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 21, in __call__\n    |     raise e\n    |   File "/usr/local/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__\n    |     await route.handle(scope, receive, send)\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle\n    |     await self.app(scope, receive, send)\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 66, in app\n    |     response = await func(request)\n    |                ^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 237, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 163, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/app/app/router/resumo_router.py", line 13, in obter_resumo\n    |     return resumo_service.obter_resumo_existente(url)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/app/app/service/resumo_service.py", line 56, in obter_resumo_existente\n    |     resumo = self.resumo_repository.buscar_por_url(url)\n    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/app/app/dataprovider/database/repository/resumo_repository.py", line 20, in buscar_por_url\n    |     return self.db.query(Resumo).filter(Resumo.url == url).first()\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2743, in first\n    |     return self.limit(1)._iter().first()  # type: ignore\n    |            ^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2842, in _iter\n    |     result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(\n    |                                                   ^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2262, in execute\n    |     return self._execute_internal(\n    |            ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2134, in _execute_internal\n    |     conn = self._connection_for_bind(bind)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2001, in _connection_for_bind\n    |     return trans._connection_for_bind(engine, execution_options)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "<string>", line 2, in _connection_for_bind\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go\n    |     ret_value = fn(self, *arg, **kw)\n    |                 ^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1126, in _connection_for_bind\n    |     conn = bind.connect()\n    |            ^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3264, in connect\n    |     return self._connection_cls(self)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 147, in __init__\n    |     Connection._handle_dbapi_exception_noconnection(\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2426, in _handle_dbapi_exception_noconnection\n    |     raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 145, in __init__\n    |     self._dbapi_connection = engine.raw_connection()\n    |                              ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3288, in raw_connection\n    |     return self.pool.connect()\n    |            ^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 452, in connect\n    |     return _ConnectionFairy._checkout(self)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 1267, in _checkout\n    |     fairy = _ConnectionRecord.checkout(pool)\n    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 716, in checkout\n    |     rec = pool._do_get()\n    |           ^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get\n    |     with util.safe_reraise():\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__\n    |     raise exc_value.with_traceback(exc_tb)\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 167, in _do_get\n    |     return self._create_connection()\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 393, in _create_connection\n    |     return _ConnectionRecord(self)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 678, in __init__\n    |     self.__connect()\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 902, in __connect\n    |     with util.safe_reraise():\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__\n    |     raise exc_value.with_traceback(exc_tb)\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 898, in __connect\n    |     self.dbapi_connection = connection = pool._invoke_creator(self)\n    |                                          ^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/create.py", line 637, in connect\n    |     return dialect.connect(*cargs, **cparams)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 615, in connect\n    |     return self.loaded_dbapi.connect(*cargs, **cparams)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/psycopg2/__init__.py", line 122, in connect\n    |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    | sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: Connection refused\n    | \tIs the server running on that host and accepting TCP/IP connections?\n    | connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused\n    | \tIs the server running on that host and accepting TCP/IP connections?\n    | \n    | (Background on this error at: https://sqlalche.me/e/20/e3q8)\n    +------------------------------------\n'}, 'request': {'method': 'GET', 'url': 'http://localhost:8080/resumos?url=https%3A%2F%2Fwww.wikipedia.org%2Fteste', 'headers': {'host': 'localhost:8080', 'user-agent': 'insomnia/10.0.0', 'correlationid': '12345', 'accept': '*/*'}}}
2024-10-01 02:57:13,310 - app.exception.handler_excecao - ERROR - {'correlation_id': '12345', 'error': {'type': 'ExceptionGroup', 'message': 'unhandled errors in a TaskGroup (1 sub-exception)', 'traceback': 'Traceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 108, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/app/app/logging/logging_interceptor.py", line 17, in log_request\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 84, in call_next\n    raise app_exc\n  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File "/usr/local/lib/python3.11/site-packages/prometheus_fastapi_instrumentator/middleware.py", line 155, in __call__\n    raise exc\n  File "/usr/local/lib/python3.11/site-packages/prometheus_fastapi_instrumentator/middleware.py", line 153, in __call__\n    await self.app(scope, receive, send_wrapper)\n  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__\n    raise exc\n  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__\n    await self.app(scope, receive, sender)\n  File "/usr/local/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 21, in __call__\n    raise e\n  File "/usr/local/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__\n    await self.app(scope, receive, send)\n  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__\n    await route.handle(scope, receive, send)\n  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle\n    await self.app(scope, receive, send)\n  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 66, in app\n    response = await func(request)\n               ^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 237, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 163, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/app/app/router/resumo_router.py", line 13, in obter_resumo\n    return resumo_service.obter_resumo_existente(url)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/app/app/service/resumo_service.py", line 56, in obter_resumo_existente\n    resumo = self.resumo_repository.buscar_por_url(url)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/app/app/dataprovider/database/repository/resumo_repository.py", line 20, in buscar_por_url\n    return self.db.query(Resumo).filter(Resumo.url == url).first()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2743, in first\n    return self.limit(1)._iter().first()  # type: ignore\n           ^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2842, in _iter\n    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(\n                                                  ^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2262, in execute\n    return self._execute_internal(\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2134, in _execute_internal\n    conn = self._connection_for_bind(bind)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2001, in _connection_for_bind\n    return trans._connection_for_bind(engine, execution_options)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "<string>", line 2, in _connection_for_bind\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1126, in _connection_for_bind\n    conn = bind.connect()\n           ^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3264, in connect\n    return self._connection_cls(self)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 147, in __init__\n    Connection._handle_dbapi_exception_noconnection(\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2426, in _handle_dbapi_exception_noconnection\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 145, in __init__\n    self._dbapi_connection = engine.raw_connection()\n                             ^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3288, in raw_connection\n    return self.pool.connect()\n           ^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 452, in connect\n    return _ConnectionFairy._checkout(self)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 1267, in _checkout\n    fairy = _ConnectionRecord.checkout(pool)\n            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 716, in checkout\n    rec = pool._do_get()\n          ^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get\n    with util.safe_reraise():\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 167, in _do_get\n    return self._create_connection()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 393, in _create_connection\n    return _ConnectionRecord(self)\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 678, in __init__\n    self.__connect()\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 902, in __connect\n    with util.safe_reraise():\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 898, in __connect\n    self.dbapi_connection = connection = pool._invoke_creator(self)\n                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/create.py", line 637, in connect\n    return dialect.connect(*cargs, **cparams)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 615, in connect\n    return self.loaded_dbapi.connect(*cargs, **cparams)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/psycopg2/__init__.py", line 122, in connect\n    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nsqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: Connection refused\n\tIs the server running on that host and accepting TCP/IP connections?\nconnection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused\n\tIs the server running on that host and accepting TCP/IP connections?\n\n(Background on this error at: https://sqlalche.me/e/20/e3q8)\n\nDuring handling of the above exception, another exception occurred:\n\n  + Exception Group Traceback (most recent call last):\n  |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__\n  |     await self.app(scope, receive, _send)\n  |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 106, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |   File "/usr/local/lib/python3.11/site-packages/anyio/_backends/_asyncio.py", line 736, in __aexit__\n  |     raise BaseExceptionGroup(\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 145, in __init__\n    |     self._dbapi_connection = engine.raw_connection()\n    |                              ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3288, in raw_connection\n    |     return self.pool.connect()\n    |            ^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 452, in connect\n    |     return _ConnectionFairy._checkout(self)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 1267, in _checkout\n    |     fairy = _ConnectionRecord.checkout(pool)\n    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 716, in checkout\n    |     rec = pool._do_get()\n    |           ^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get\n    |     with util.safe_reraise():\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__\n    |     raise exc_value.with_traceback(exc_tb)\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 167, in _do_get\n    |     return self._create_connection()\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 393, in _create_connection\n    |     return _ConnectionRecord(self)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 678, in __init__\n    |     self.__connect()\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 902, in __connect\n    |     with util.safe_reraise():\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__\n    |     raise exc_value.with_traceback(exc_tb)\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 898, in __connect\n    |     self.dbapi_connection = connection = pool._invoke_creator(self)\n    |                                          ^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/create.py", line 637, in connect\n    |     return dialect.connect(*cargs, **cparams)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 615, in connect\n    |     return self.loaded_dbapi.connect(*cargs, **cparams)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/psycopg2/__init__.py", line 122, in connect\n    |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    | psycopg2.OperationalError: connection to server at "localhost" (::1), port 5432 failed: Connection refused\n    | \tIs the server running on that host and accepting TCP/IP connections?\n    | connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused\n    | \tIs the server running on that host and accepting TCP/IP connections?\n    | \n    | \n    | The above exception was the direct cause of the following exception:\n    | \n    | Traceback (most recent call last):\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 108, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/app/app/logging/logging_interceptor.py", line 17, in log_request\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 84, in call_next\n    |     raise app_exc\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 70, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File "/usr/local/lib/python3.11/site-packages/prometheus_fastapi_instrumentator/middleware.py", line 155, in __call__\n    |     raise exc\n    |   File "/usr/local/lib/python3.11/site-packages/prometheus_fastapi_instrumentator/middleware.py", line 153, in __call__\n    |     await self.app(scope, receive, send_wrapper)\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__\n    |     raise exc\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__\n    |     await self.app(scope, receive, sender)\n    |   File "/usr/local/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 21, in __call__\n    |     raise e\n    |   File "/usr/local/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__\n    |     await route.handle(scope, receive, send)\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle\n    |     await self.app(scope, receive, send)\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 66, in app\n    |     response = await func(request)\n    |                ^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 237, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 163, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/app/app/router/resumo_router.py", line 13, in obter_resumo\n    |     return resumo_service.obter_resumo_existente(url)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/app/app/service/resumo_service.py", line 56, in obter_resumo_existente\n    |     resumo = self.resumo_repository.buscar_por_url(url)\n    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/app/app/dataprovider/database/repository/resumo_repository.py", line 20, in buscar_por_url\n    |     return self.db.query(Resumo).filter(Resumo.url == url).first()\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2743, in first\n    |     return self.limit(1)._iter().first()  # type: ignore\n    |            ^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2842, in _iter\n    |     result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(\n    |                                                   ^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2262, in execute\n    |     return self._execute_internal(\n    |            ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2134, in _execute_internal\n    |     conn = self._connection_for_bind(bind)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2001, in _connection_for_bind\n    |     return trans._connection_for_bind(engine, execution_options)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "<string>", line 2, in _connection_for_bind\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go\n    |     ret_value = fn(self, *arg, **kw)\n    |                 ^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1126, in _connection_for_bind\n    |     conn = bind.connect()\n    |            ^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3264, in connect\n    |     return self._connection_cls(self)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 147, in __init__\n    |     Connection._handle_dbapi_exception_noconnection(\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2426, in _handle_dbapi_exception_noconnection\n    |     raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 145, in __init__\n    |     self._dbapi_connection = engine.raw_connection()\n    |                              ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3288, in raw_connection\n    |     return self.pool.connect()\n    |            ^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 452, in connect\n    |     return _ConnectionFairy._checkout(self)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 1267, in _checkout\n    |     fairy = _ConnectionRecord.checkout(pool)\n    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 716, in checkout\n    |     rec = pool._do_get()\n    |           ^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get\n    |     with util.safe_reraise():\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__\n    |     raise exc_value.with_traceback(exc_tb)\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 167, in _do_get\n    |     return self._create_connection()\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 393, in _create_connection\n    |     return _ConnectionRecord(self)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 678, in __init__\n    |     self.__connect()\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 902, in __connect\n    |     with util.safe_reraise():\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__\n    |     raise exc_value.with_traceback(exc_tb)\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 898, in __connect\n    |     self.dbapi_connection = connection = pool._invoke_creator(self)\n    |                                          ^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/create.py", line 637, in connect\n    |     return dialect.connect(*cargs, **cparams)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 615, in connect\n    |     return self.loaded_dbapi.connect(*cargs, **cparams)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/psycopg2/__init__.py", line 122, in connect\n    |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    | sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: Connection refused\n    | \tIs the server running on that host and accepting TCP/IP connections?\n    | connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused\n    | \tIs the server running on that host and accepting TCP/IP connections?\n    | \n    | (Background on this error at: https://sqlalche.me/e/20/e3q8)\n    +------------------------------------\n'}, 'request': {'method': 'GET', 'url': 'http://localhost:8080/resumos?url=https%3A%2F%2Fwww.wikipedia.org%2Fteste', 'headers': {'host': 'localhost:8080', 'user-agent': 'insomnia/10.0.0', 'correlationid': '12345', 'accept': '*/*'}}}
2024-10-01 02:57:13,577 - app.exception.handler_excecao - ERROR - {'correlation_id': '12345', 'error': {'type': 'ExceptionGroup', 'message': 'unhandled errors in a TaskGroup (1 sub-exception)', 'traceback': 'Traceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 108, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/app/app/logging/logging_interceptor.py", line 17, in log_request\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 84, in call_next\n    raise app_exc\n  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File "/usr/local/lib/python3.11/site-packages/prometheus_fastapi_instrumentator/middleware.py", line 155, in __call__\n    raise exc\n  File "/usr/local/lib/python3.11/site-packages/prometheus_fastapi_instrumentator/middleware.py", line 153, in __call__\n    await self.app(scope, receive, send_wrapper)\n  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__\n    raise exc\n  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__\n    await self.app(scope, receive, sender)\n  File "/usr/local/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 21, in __call__\n    raise e\n  File "/usr/local/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__\n    await self.app(scope, receive, send)\n  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__\n    await route.handle(scope, receive, send)\n  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle\n    await self.app(scope, receive, send)\n  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 66, in app\n    response = await func(request)\n               ^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 237, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 163, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/app/app/router/resumo_router.py", line 13, in obter_resumo\n    return resumo_service.obter_resumo_existente(url)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/app/app/service/resumo_service.py", line 56, in obter_resumo_existente\n    resumo = self.resumo_repository.buscar_por_url(url)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/app/app/dataprovider/database/repository/resumo_repository.py", line 20, in buscar_por_url\n    return self.db.query(Resumo).filter(Resumo.url == url).first()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2743, in first\n    return self.limit(1)._iter().first()  # type: ignore\n           ^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2842, in _iter\n    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(\n                                                  ^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2262, in execute\n    return self._execute_internal(\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2134, in _execute_internal\n    conn = self._connection_for_bind(bind)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2001, in _connection_for_bind\n    return trans._connection_for_bind(engine, execution_options)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "<string>", line 2, in _connection_for_bind\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1126, in _connection_for_bind\n    conn = bind.connect()\n           ^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3264, in connect\n    return self._connection_cls(self)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 147, in __init__\n    Connection._handle_dbapi_exception_noconnection(\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2426, in _handle_dbapi_exception_noconnection\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 145, in __init__\n    self._dbapi_connection = engine.raw_connection()\n                             ^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3288, in raw_connection\n    return self.pool.connect()\n           ^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 452, in connect\n    return _ConnectionFairy._checkout(self)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 1267, in _checkout\n    fairy = _ConnectionRecord.checkout(pool)\n            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 716, in checkout\n    rec = pool._do_get()\n          ^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get\n    with util.safe_reraise():\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 167, in _do_get\n    return self._create_connection()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 393, in _create_connection\n    return _ConnectionRecord(self)\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 678, in __init__\n    self.__connect()\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 902, in __connect\n    with util.safe_reraise():\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 898, in __connect\n    self.dbapi_connection = connection = pool._invoke_creator(self)\n                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/create.py", line 637, in connect\n    return dialect.connect(*cargs, **cparams)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 615, in connect\n    return self.loaded_dbapi.connect(*cargs, **cparams)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/psycopg2/__init__.py", line 122, in connect\n    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nsqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: Connection refused\n\tIs the server running on that host and accepting TCP/IP connections?\nconnection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused\n\tIs the server running on that host and accepting TCP/IP connections?\n\n(Background on this error at: https://sqlalche.me/e/20/e3q8)\n\nDuring handling of the above exception, another exception occurred:\n\n  + Exception Group Traceback (most recent call last):\n  |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__\n  |     await self.app(scope, receive, _send)\n  |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 106, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |   File "/usr/local/lib/python3.11/site-packages/anyio/_backends/_asyncio.py", line 736, in __aexit__\n  |     raise BaseExceptionGroup(\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 145, in __init__\n    |     self._dbapi_connection = engine.raw_connection()\n    |                              ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3288, in raw_connection\n    |     return self.pool.connect()\n    |            ^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 452, in connect\n    |     return _ConnectionFairy._checkout(self)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 1267, in _checkout\n    |     fairy = _ConnectionRecord.checkout(pool)\n    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 716, in checkout\n    |     rec = pool._do_get()\n    |           ^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get\n    |     with util.safe_reraise():\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__\n    |     raise exc_value.with_traceback(exc_tb)\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 167, in _do_get\n    |     return self._create_connection()\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 393, in _create_connection\n    |     return _ConnectionRecord(self)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 678, in __init__\n    |     self.__connect()\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 902, in __connect\n    |     with util.safe_reraise():\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__\n    |     raise exc_value.with_traceback(exc_tb)\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 898, in __connect\n    |     self.dbapi_connection = connection = pool._invoke_creator(self)\n    |                                          ^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/create.py", line 637, in connect\n    |     return dialect.connect(*cargs, **cparams)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 615, in connect\n    |     return self.loaded_dbapi.connect(*cargs, **cparams)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/psycopg2/__init__.py", line 122, in connect\n    |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    | psycopg2.OperationalError: connection to server at "localhost" (::1), port 5432 failed: Connection refused\n    | \tIs the server running on that host and accepting TCP/IP connections?\n    | connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused\n    | \tIs the server running on that host and accepting TCP/IP connections?\n    | \n    | \n    | The above exception was the direct cause of the following exception:\n    | \n    | Traceback (most recent call last):\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 108, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/app/app/logging/logging_interceptor.py", line 17, in log_request\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 84, in call_next\n    |     raise app_exc\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 70, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File "/usr/local/lib/python3.11/site-packages/prometheus_fastapi_instrumentator/middleware.py", line 155, in __call__\n    |     raise exc\n    |   File "/usr/local/lib/python3.11/site-packages/prometheus_fastapi_instrumentator/middleware.py", line 153, in __call__\n    |     await self.app(scope, receive, send_wrapper)\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__\n    |     raise exc\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__\n    |     await self.app(scope, receive, sender)\n    |   File "/usr/local/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 21, in __call__\n    |     raise e\n    |   File "/usr/local/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__\n    |     await route.handle(scope, receive, send)\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle\n    |     await self.app(scope, receive, send)\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 66, in app\n    |     response = await func(request)\n    |                ^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 237, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 163, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/app/app/router/resumo_router.py", line 13, in obter_resumo\n    |     return resumo_service.obter_resumo_existente(url)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/app/app/service/resumo_service.py", line 56, in obter_resumo_existente\n    |     resumo = self.resumo_repository.buscar_por_url(url)\n    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/app/app/dataprovider/database/repository/resumo_repository.py", line 20, in buscar_por_url\n    |     return self.db.query(Resumo).filter(Resumo.url == url).first()\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2743, in first\n    |     return self.limit(1)._iter().first()  # type: ignore\n    |            ^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2842, in _iter\n    |     result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(\n    |                                                   ^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2262, in execute\n    |     return self._execute_internal(\n    |            ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2134, in _execute_internal\n    |     conn = self._connection_for_bind(bind)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2001, in _connection_for_bind\n    |     return trans._connection_for_bind(engine, execution_options)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "<string>", line 2, in _connection_for_bind\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go\n    |     ret_value = fn(self, *arg, **kw)\n    |                 ^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1126, in _connection_for_bind\n    |     conn = bind.connect()\n    |            ^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3264, in connect\n    |     return self._connection_cls(self)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 147, in __init__\n    |     Connection._handle_dbapi_exception_noconnection(\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2426, in _handle_dbapi_exception_noconnection\n    |     raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 145, in __init__\n    |     self._dbapi_connection = engine.raw_connection()\n    |                              ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3288, in raw_connection\n    |     return self.pool.connect()\n    |            ^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 452, in connect\n    |     return _ConnectionFairy._checkout(self)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 1267, in _checkout\n    |     fairy = _ConnectionRecord.checkout(pool)\n    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 716, in checkout\n    |     rec = pool._do_get()\n    |           ^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get\n    |     with util.safe_reraise():\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__\n    |     raise exc_value.with_traceback(exc_tb)\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 167, in _do_get\n    |     return self._create_connection()\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 393, in _create_connection\n    |     return _ConnectionRecord(self)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 678, in __init__\n    |     self.__connect()\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 902, in __connect\n    |     with util.safe_reraise():\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__\n    |     raise exc_value.with_traceback(exc_tb)\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 898, in __connect\n    |     self.dbapi_connection = connection = pool._invoke_creator(self)\n    |                                          ^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/create.py", line 637, in connect\n    |     return dialect.connect(*cargs, **cparams)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 615, in connect\n    |     return self.loaded_dbapi.connect(*cargs, **cparams)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/psycopg2/__init__.py", line 122, in connect\n    |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    | sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: Connection refused\n    | \tIs the server running on that host and accepting TCP/IP connections?\n    | connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused\n    | \tIs the server running on that host and accepting TCP/IP connections?\n    | \n    | (Background on this error at: https://sqlalche.me/e/20/e3q8)\n    +------------------------------------\n'}, 'request': {'method': 'GET', 'url': 'http://localhost:8080/resumos?url=https%3A%2F%2Fwww.wikipedia.org%2Fteste', 'headers': {'host': 'localhost:8080', 'user-agent': 'insomnia/10.0.0', 'correlationid': '12345', 'accept': '*/*'}}}
2024-10-01 02:57:13,835 - app.exception.handler_excecao - ERROR - {'correlation_id': '12345', 'error': {'type': 'ExceptionGroup', 'message': 'unhandled errors in a TaskGroup (1 sub-exception)', 'traceback': 'Traceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 108, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/app/app/logging/logging_interceptor.py", line 17, in log_request\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 84, in call_next\n    raise app_exc\n  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File "/usr/local/lib/python3.11/site-packages/prometheus_fastapi_instrumentator/middleware.py", line 155, in __call__\n    raise exc\n  File "/usr/local/lib/python3.11/site-packages/prometheus_fastapi_instrumentator/middleware.py", line 153, in __call__\n    await self.app(scope, receive, send_wrapper)\n  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__\n    raise exc\n  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__\n    await self.app(scope, receive, sender)\n  File "/usr/local/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 21, in __call__\n    raise e\n  File "/usr/local/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__\n    await self.app(scope, receive, send)\n  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__\n    await route.handle(scope, receive, send)\n  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle\n    await self.app(scope, receive, send)\n  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 66, in app\n    response = await func(request)\n               ^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 237, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 163, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/app/app/router/resumo_router.py", line 13, in obter_resumo\n    return resumo_service.obter_resumo_existente(url)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/app/app/service/resumo_service.py", line 56, in obter_resumo_existente\n    resumo = self.resumo_repository.buscar_por_url(url)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/app/app/dataprovider/database/repository/resumo_repository.py", line 20, in buscar_por_url\n    return self.db.query(Resumo).filter(Resumo.url == url).first()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2743, in first\n    return self.limit(1)._iter().first()  # type: ignore\n           ^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2842, in _iter\n    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(\n                                                  ^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2262, in execute\n    return self._execute_internal(\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2134, in _execute_internal\n    conn = self._connection_for_bind(bind)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2001, in _connection_for_bind\n    return trans._connection_for_bind(engine, execution_options)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "<string>", line 2, in _connection_for_bind\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1126, in _connection_for_bind\n    conn = bind.connect()\n           ^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3264, in connect\n    return self._connection_cls(self)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 147, in __init__\n    Connection._handle_dbapi_exception_noconnection(\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2426, in _handle_dbapi_exception_noconnection\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 145, in __init__\n    self._dbapi_connection = engine.raw_connection()\n                             ^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3288, in raw_connection\n    return self.pool.connect()\n           ^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 452, in connect\n    return _ConnectionFairy._checkout(self)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 1267, in _checkout\n    fairy = _ConnectionRecord.checkout(pool)\n            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 716, in checkout\n    rec = pool._do_get()\n          ^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get\n    with util.safe_reraise():\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 167, in _do_get\n    return self._create_connection()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 393, in _create_connection\n    return _ConnectionRecord(self)\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 678, in __init__\n    self.__connect()\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 902, in __connect\n    with util.safe_reraise():\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 898, in __connect\n    self.dbapi_connection = connection = pool._invoke_creator(self)\n                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/create.py", line 637, in connect\n    return dialect.connect(*cargs, **cparams)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 615, in connect\n    return self.loaded_dbapi.connect(*cargs, **cparams)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/psycopg2/__init__.py", line 122, in connect\n    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nsqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: Connection refused\n\tIs the server running on that host and accepting TCP/IP connections?\nconnection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused\n\tIs the server running on that host and accepting TCP/IP connections?\n\n(Background on this error at: https://sqlalche.me/e/20/e3q8)\n\nDuring handling of the above exception, another exception occurred:\n\n  + Exception Group Traceback (most recent call last):\n  |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__\n  |     await self.app(scope, receive, _send)\n  |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 106, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |   File "/usr/local/lib/python3.11/site-packages/anyio/_backends/_asyncio.py", line 736, in __aexit__\n  |     raise BaseExceptionGroup(\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 145, in __init__\n    |     self._dbapi_connection = engine.raw_connection()\n    |                              ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3288, in raw_connection\n    |     return self.pool.connect()\n    |            ^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 452, in connect\n    |     return _ConnectionFairy._checkout(self)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 1267, in _checkout\n    |     fairy = _ConnectionRecord.checkout(pool)\n    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 716, in checkout\n    |     rec = pool._do_get()\n    |           ^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get\n    |     with util.safe_reraise():\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__\n    |     raise exc_value.with_traceback(exc_tb)\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 167, in _do_get\n    |     return self._create_connection()\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 393, in _create_connection\n    |     return _ConnectionRecord(self)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 678, in __init__\n    |     self.__connect()\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 902, in __connect\n    |     with util.safe_reraise():\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__\n    |     raise exc_value.with_traceback(exc_tb)\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 898, in __connect\n    |     self.dbapi_connection = connection = pool._invoke_creator(self)\n    |                                          ^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/create.py", line 637, in connect\n    |     return dialect.connect(*cargs, **cparams)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 615, in connect\n    |     return self.loaded_dbapi.connect(*cargs, **cparams)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/psycopg2/__init__.py", line 122, in connect\n    |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    | psycopg2.OperationalError: connection to server at "localhost" (::1), port 5432 failed: Connection refused\n    | \tIs the server running on that host and accepting TCP/IP connections?\n    | connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused\n    | \tIs the server running on that host and accepting TCP/IP connections?\n    | \n    | \n    | The above exception was the direct cause of the following exception:\n    | \n    | Traceback (most recent call last):\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 108, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/app/app/logging/logging_interceptor.py", line 17, in log_request\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 84, in call_next\n    |     raise app_exc\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 70, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File "/usr/local/lib/python3.11/site-packages/prometheus_fastapi_instrumentator/middleware.py", line 155, in __call__\n    |     raise exc\n    |   File "/usr/local/lib/python3.11/site-packages/prometheus_fastapi_instrumentator/middleware.py", line 153, in __call__\n    |     await self.app(scope, receive, send_wrapper)\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__\n    |     raise exc\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__\n    |     await self.app(scope, receive, sender)\n    |   File "/usr/local/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 21, in __call__\n    |     raise e\n    |   File "/usr/local/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__\n    |     await route.handle(scope, receive, send)\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle\n    |     await self.app(scope, receive, send)\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 66, in app\n    |     response = await func(request)\n    |                ^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 237, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 163, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/app/app/router/resumo_router.py", line 13, in obter_resumo\n    |     return resumo_service.obter_resumo_existente(url)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/app/app/service/resumo_service.py", line 56, in obter_resumo_existente\n    |     resumo = self.resumo_repository.buscar_por_url(url)\n    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/app/app/dataprovider/database/repository/resumo_repository.py", line 20, in buscar_por_url\n    |     return self.db.query(Resumo).filter(Resumo.url == url).first()\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2743, in first\n    |     return self.limit(1)._iter().first()  # type: ignore\n    |            ^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2842, in _iter\n    |     result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(\n    |                                                   ^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2262, in execute\n    |     return self._execute_internal(\n    |            ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2134, in _execute_internal\n    |     conn = self._connection_for_bind(bind)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2001, in _connection_for_bind\n    |     return trans._connection_for_bind(engine, execution_options)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "<string>", line 2, in _connection_for_bind\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go\n    |     ret_value = fn(self, *arg, **kw)\n    |                 ^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1126, in _connection_for_bind\n    |     conn = bind.connect()\n    |            ^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3264, in connect\n    |     return self._connection_cls(self)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 147, in __init__\n    |     Connection._handle_dbapi_exception_noconnection(\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2426, in _handle_dbapi_exception_noconnection\n    |     raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 145, in __init__\n    |     self._dbapi_connection = engine.raw_connection()\n    |                              ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3288, in raw_connection\n    |     return self.pool.connect()\n    |            ^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 452, in connect\n    |     return _ConnectionFairy._checkout(self)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 1267, in _checkout\n    |     fairy = _ConnectionRecord.checkout(pool)\n    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 716, in checkout\n    |     rec = pool._do_get()\n    |           ^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get\n    |     with util.safe_reraise():\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__\n    |     raise exc_value.with_traceback(exc_tb)\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 167, in _do_get\n    |     return self._create_connection()\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 393, in _create_connection\n    |     return _ConnectionRecord(self)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 678, in __init__\n    |     self.__connect()\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 902, in __connect\n    |     with util.safe_reraise():\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__\n    |     raise exc_value.with_traceback(exc_tb)\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 898, in __connect\n    |     self.dbapi_connection = connection = pool._invoke_creator(self)\n    |                                          ^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/create.py", line 637, in connect\n    |     return dialect.connect(*cargs, **cparams)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 615, in connect\n    |     return self.loaded_dbapi.connect(*cargs, **cparams)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/psycopg2/__init__.py", line 122, in connect\n    |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    | sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: Connection refused\n    | \tIs the server running on that host and accepting TCP/IP connections?\n    | connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused\n    | \tIs the server running on that host and accepting TCP/IP connections?\n    | \n    | (Background on this error at: https://sqlalche.me/e/20/e3q8)\n    +------------------------------------\n'}, 'request': {'method': 'GET', 'url': 'http://localhost:8080/resumos?url=https%3A%2F%2Fwww.wikipedia.org%2Fteste', 'headers': {'host': 'localhost:8080', 'user-agent': 'insomnia/10.0.0', 'correlationid': '12345', 'accept': '*/*'}}}
2024-10-01 02:57:14,031 - app.exception.handler_excecao - ERROR - {'correlation_id': '12345', 'error': {'type': 'ExceptionGroup', 'message': 'unhandled errors in a TaskGroup (1 sub-exception)', 'traceback': 'Traceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 108, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/app/app/logging/logging_interceptor.py", line 17, in log_request\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 84, in call_next\n    raise app_exc\n  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File "/usr/local/lib/python3.11/site-packages/prometheus_fastapi_instrumentator/middleware.py", line 155, in __call__\n    raise exc\n  File "/usr/local/lib/python3.11/site-packages/prometheus_fastapi_instrumentator/middleware.py", line 153, in __call__\n    await self.app(scope, receive, send_wrapper)\n  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__\n    raise exc\n  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__\n    await self.app(scope, receive, sender)\n  File "/usr/local/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 21, in __call__\n    raise e\n  File "/usr/local/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__\n    await self.app(scope, receive, send)\n  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__\n    await route.handle(scope, receive, send)\n  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle\n    await self.app(scope, receive, send)\n  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 66, in app\n    response = await func(request)\n               ^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 237, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 163, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/app/app/router/resumo_router.py", line 13, in obter_resumo\n    return resumo_service.obter_resumo_existente(url)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/app/app/service/resumo_service.py", line 56, in obter_resumo_existente\n    resumo = self.resumo_repository.buscar_por_url(url)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/app/app/dataprovider/database/repository/resumo_repository.py", line 20, in buscar_por_url\n    return self.db.query(Resumo).filter(Resumo.url == url).first()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2743, in first\n    return self.limit(1)._iter().first()  # type: ignore\n           ^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2842, in _iter\n    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(\n                                                  ^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2262, in execute\n    return self._execute_internal(\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2134, in _execute_internal\n    conn = self._connection_for_bind(bind)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2001, in _connection_for_bind\n    return trans._connection_for_bind(engine, execution_options)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "<string>", line 2, in _connection_for_bind\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1126, in _connection_for_bind\n    conn = bind.connect()\n           ^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3264, in connect\n    return self._connection_cls(self)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 147, in __init__\n    Connection._handle_dbapi_exception_noconnection(\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2426, in _handle_dbapi_exception_noconnection\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 145, in __init__\n    self._dbapi_connection = engine.raw_connection()\n                             ^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3288, in raw_connection\n    return self.pool.connect()\n           ^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 452, in connect\n    return _ConnectionFairy._checkout(self)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 1267, in _checkout\n    fairy = _ConnectionRecord.checkout(pool)\n            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 716, in checkout\n    rec = pool._do_get()\n          ^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get\n    with util.safe_reraise():\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 167, in _do_get\n    return self._create_connection()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 393, in _create_connection\n    return _ConnectionRecord(self)\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 678, in __init__\n    self.__connect()\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 902, in __connect\n    with util.safe_reraise():\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 898, in __connect\n    self.dbapi_connection = connection = pool._invoke_creator(self)\n                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/create.py", line 637, in connect\n    return dialect.connect(*cargs, **cparams)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 615, in connect\n    return self.loaded_dbapi.connect(*cargs, **cparams)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/psycopg2/__init__.py", line 122, in connect\n    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nsqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: Connection refused\n\tIs the server running on that host and accepting TCP/IP connections?\nconnection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused\n\tIs the server running on that host and accepting TCP/IP connections?\n\n(Background on this error at: https://sqlalche.me/e/20/e3q8)\n\nDuring handling of the above exception, another exception occurred:\n\n  + Exception Group Traceback (most recent call last):\n  |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__\n  |     await self.app(scope, receive, _send)\n  |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 106, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |   File "/usr/local/lib/python3.11/site-packages/anyio/_backends/_asyncio.py", line 736, in __aexit__\n  |     raise BaseExceptionGroup(\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 145, in __init__\n    |     self._dbapi_connection = engine.raw_connection()\n    |                              ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3288, in raw_connection\n    |     return self.pool.connect()\n    |            ^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 452, in connect\n    |     return _ConnectionFairy._checkout(self)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 1267, in _checkout\n    |     fairy = _ConnectionRecord.checkout(pool)\n    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 716, in checkout\n    |     rec = pool._do_get()\n    |           ^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get\n    |     with util.safe_reraise():\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__\n    |     raise exc_value.with_traceback(exc_tb)\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 167, in _do_get\n    |     return self._create_connection()\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 393, in _create_connection\n    |     return _ConnectionRecord(self)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 678, in __init__\n    |     self.__connect()\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 902, in __connect\n    |     with util.safe_reraise():\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__\n    |     raise exc_value.with_traceback(exc_tb)\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 898, in __connect\n    |     self.dbapi_connection = connection = pool._invoke_creator(self)\n    |                                          ^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/create.py", line 637, in connect\n    |     return dialect.connect(*cargs, **cparams)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 615, in connect\n    |     return self.loaded_dbapi.connect(*cargs, **cparams)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/psycopg2/__init__.py", line 122, in connect\n    |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    | psycopg2.OperationalError: connection to server at "localhost" (::1), port 5432 failed: Connection refused\n    | \tIs the server running on that host and accepting TCP/IP connections?\n    | connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused\n    | \tIs the server running on that host and accepting TCP/IP connections?\n    | \n    | \n    | The above exception was the direct cause of the following exception:\n    | \n    | Traceback (most recent call last):\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 108, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/app/app/logging/logging_interceptor.py", line 17, in log_request\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 84, in call_next\n    |     raise app_exc\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 70, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File "/usr/local/lib/python3.11/site-packages/prometheus_fastapi_instrumentator/middleware.py", line 155, in __call__\n    |     raise exc\n    |   File "/usr/local/lib/python3.11/site-packages/prometheus_fastapi_instrumentator/middleware.py", line 153, in __call__\n    |     await self.app(scope, receive, send_wrapper)\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__\n    |     raise exc\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__\n    |     await self.app(scope, receive, sender)\n    |   File "/usr/local/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 21, in __call__\n    |     raise e\n    |   File "/usr/local/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__\n    |     await route.handle(scope, receive, send)\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle\n    |     await self.app(scope, receive, send)\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 66, in app\n    |     response = await func(request)\n    |                ^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 237, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 163, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/app/app/router/resumo_router.py", line 13, in obter_resumo\n    |     return resumo_service.obter_resumo_existente(url)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/app/app/service/resumo_service.py", line 56, in obter_resumo_existente\n    |     resumo = self.resumo_repository.buscar_por_url(url)\n    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/app/app/dataprovider/database/repository/resumo_repository.py", line 20, in buscar_por_url\n    |     return self.db.query(Resumo).filter(Resumo.url == url).first()\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2743, in first\n    |     return self.limit(1)._iter().first()  # type: ignore\n    |            ^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2842, in _iter\n    |     result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(\n    |                                                   ^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2262, in execute\n    |     return self._execute_internal(\n    |            ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2134, in _execute_internal\n    |     conn = self._connection_for_bind(bind)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2001, in _connection_for_bind\n    |     return trans._connection_for_bind(engine, execution_options)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "<string>", line 2, in _connection_for_bind\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go\n    |     ret_value = fn(self, *arg, **kw)\n    |                 ^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1126, in _connection_for_bind\n    |     conn = bind.connect()\n    |            ^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3264, in connect\n    |     return self._connection_cls(self)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 147, in __init__\n    |     Connection._handle_dbapi_exception_noconnection(\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2426, in _handle_dbapi_exception_noconnection\n    |     raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 145, in __init__\n    |     self._dbapi_connection = engine.raw_connection()\n    |                              ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3288, in raw_connection\n    |     return self.pool.connect()\n    |            ^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 452, in connect\n    |     return _ConnectionFairy._checkout(self)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 1267, in _checkout\n    |     fairy = _ConnectionRecord.checkout(pool)\n    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 716, in checkout\n    |     rec = pool._do_get()\n    |           ^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get\n    |     with util.safe_reraise():\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__\n    |     raise exc_value.with_traceback(exc_tb)\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 167, in _do_get\n    |     return self._create_connection()\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 393, in _create_connection\n    |     return _ConnectionRecord(self)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 678, in __init__\n    |     self.__connect()\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 902, in __connect\n    |     with util.safe_reraise():\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__\n    |     raise exc_value.with_traceback(exc_tb)\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 898, in __connect\n    |     self.dbapi_connection = connection = pool._invoke_creator(self)\n    |                                          ^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/create.py", line 637, in connect\n    |     return dialect.connect(*cargs, **cparams)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 615, in connect\n    |     return self.loaded_dbapi.connect(*cargs, **cparams)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/psycopg2/__init__.py", line 122, in connect\n    |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    | sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: Connection refused\n    | \tIs the server running on that host and accepting TCP/IP connections?\n    | connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused\n    | \tIs the server running on that host and accepting TCP/IP connections?\n    | \n    | (Background on this error at: https://sqlalche.me/e/20/e3q8)\n    +------------------------------------\n'}, 'request': {'method': 'GET', 'url': 'http://localhost:8080/resumos?url=https%3A%2F%2Fwww.wikipedia.org%2Fteste', 'headers': {'host': 'localhost:8080', 'user-agent': 'insomnia/10.0.0', 'correlationid': '12345', 'accept': '*/*'}}}
2024-10-01 02:57:14,231 - app.exception.handler_excecao - ERROR - {'correlation_id': '12345', 'error': {'type': 'ExceptionGroup', 'message': 'unhandled errors in a TaskGroup (1 sub-exception)', 'traceback': 'Traceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 108, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/app/app/logging/logging_interceptor.py", line 17, in log_request\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 84, in call_next\n    raise app_exc\n  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File "/usr/local/lib/python3.11/site-packages/prometheus_fastapi_instrumentator/middleware.py", line 155, in __call__\n    raise exc\n  File "/usr/local/lib/python3.11/site-packages/prometheus_fastapi_instrumentator/middleware.py", line 153, in __call__\n    await self.app(scope, receive, send_wrapper)\n  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__\n    raise exc\n  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__\n    await self.app(scope, receive, sender)\n  File "/usr/local/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 21, in __call__\n    raise e\n  File "/usr/local/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__\n    await self.app(scope, receive, send)\n  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__\n    await route.handle(scope, receive, send)\n  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle\n    await self.app(scope, receive, send)\n  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 66, in app\n    response = await func(request)\n               ^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 237, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 163, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/app/app/router/resumo_router.py", line 13, in obter_resumo\n    return resumo_service.obter_resumo_existente(url)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/app/app/service/resumo_service.py", line 56, in obter_resumo_existente\n    resumo = self.resumo_repository.buscar_por_url(url)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/app/app/dataprovider/database/repository/resumo_repository.py", line 20, in buscar_por_url\n    return self.db.query(Resumo).filter(Resumo.url == url).first()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2743, in first\n    return self.limit(1)._iter().first()  # type: ignore\n           ^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2842, in _iter\n    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(\n                                                  ^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2262, in execute\n    return self._execute_internal(\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2134, in _execute_internal\n    conn = self._connection_for_bind(bind)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2001, in _connection_for_bind\n    return trans._connection_for_bind(engine, execution_options)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "<string>", line 2, in _connection_for_bind\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1126, in _connection_for_bind\n    conn = bind.connect()\n           ^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3264, in connect\n    return self._connection_cls(self)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 147, in __init__\n    Connection._handle_dbapi_exception_noconnection(\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2426, in _handle_dbapi_exception_noconnection\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 145, in __init__\n    self._dbapi_connection = engine.raw_connection()\n                             ^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3288, in raw_connection\n    return self.pool.connect()\n           ^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 452, in connect\n    return _ConnectionFairy._checkout(self)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 1267, in _checkout\n    fairy = _ConnectionRecord.checkout(pool)\n            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 716, in checkout\n    rec = pool._do_get()\n          ^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get\n    with util.safe_reraise():\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 167, in _do_get\n    return self._create_connection()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 393, in _create_connection\n    return _ConnectionRecord(self)\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 678, in __init__\n    self.__connect()\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 902, in __connect\n    with util.safe_reraise():\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 898, in __connect\n    self.dbapi_connection = connection = pool._invoke_creator(self)\n                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/create.py", line 637, in connect\n    return dialect.connect(*cargs, **cparams)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 615, in connect\n    return self.loaded_dbapi.connect(*cargs, **cparams)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/psycopg2/__init__.py", line 122, in connect\n    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nsqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: Connection refused\n\tIs the server running on that host and accepting TCP/IP connections?\nconnection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused\n\tIs the server running on that host and accepting TCP/IP connections?\n\n(Background on this error at: https://sqlalche.me/e/20/e3q8)\n\nDuring handling of the above exception, another exception occurred:\n\n  + Exception Group Traceback (most recent call last):\n  |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__\n  |     await self.app(scope, receive, _send)\n  |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 106, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |   File "/usr/local/lib/python3.11/site-packages/anyio/_backends/_asyncio.py", line 736, in __aexit__\n  |     raise BaseExceptionGroup(\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 145, in __init__\n    |     self._dbapi_connection = engine.raw_connection()\n    |                              ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3288, in raw_connection\n    |     return self.pool.connect()\n    |            ^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 452, in connect\n    |     return _ConnectionFairy._checkout(self)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 1267, in _checkout\n    |     fairy = _ConnectionRecord.checkout(pool)\n    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 716, in checkout\n    |     rec = pool._do_get()\n    |           ^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get\n    |     with util.safe_reraise():\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__\n    |     raise exc_value.with_traceback(exc_tb)\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 167, in _do_get\n    |     return self._create_connection()\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 393, in _create_connection\n    |     return _ConnectionRecord(self)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 678, in __init__\n    |     self.__connect()\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 902, in __connect\n    |     with util.safe_reraise():\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__\n    |     raise exc_value.with_traceback(exc_tb)\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 898, in __connect\n    |     self.dbapi_connection = connection = pool._invoke_creator(self)\n    |                                          ^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/create.py", line 637, in connect\n    |     return dialect.connect(*cargs, **cparams)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 615, in connect\n    |     return self.loaded_dbapi.connect(*cargs, **cparams)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/psycopg2/__init__.py", line 122, in connect\n    |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    | psycopg2.OperationalError: connection to server at "localhost" (::1), port 5432 failed: Connection refused\n    | \tIs the server running on that host and accepting TCP/IP connections?\n    | connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused\n    | \tIs the server running on that host and accepting TCP/IP connections?\n    | \n    | \n    | The above exception was the direct cause of the following exception:\n    | \n    | Traceback (most recent call last):\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 108, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/app/app/logging/logging_interceptor.py", line 17, in log_request\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 84, in call_next\n    |     raise app_exc\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 70, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File "/usr/local/lib/python3.11/site-packages/prometheus_fastapi_instrumentator/middleware.py", line 155, in __call__\n    |     raise exc\n    |   File "/usr/local/lib/python3.11/site-packages/prometheus_fastapi_instrumentator/middleware.py", line 153, in __call__\n    |     await self.app(scope, receive, send_wrapper)\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__\n    |     raise exc\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__\n    |     await self.app(scope, receive, sender)\n    |   File "/usr/local/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 21, in __call__\n    |     raise e\n    |   File "/usr/local/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__\n    |     await route.handle(scope, receive, send)\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle\n    |     await self.app(scope, receive, send)\n    |   File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 66, in app\n    |     response = await func(request)\n    |                ^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 237, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 163, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/app/app/router/resumo_router.py", line 13, in obter_resumo\n    |     return resumo_service.obter_resumo_existente(url)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/app/app/service/resumo_service.py", line 56, in obter_resumo_existente\n    |     resumo = self.resumo_repository.buscar_por_url(url)\n    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/app/app/dataprovider/database/repository/resumo_repository.py", line 20, in buscar_por_url\n    |     return self.db.query(Resumo).filter(Resumo.url == url).first()\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2743, in first\n    |     return self.limit(1)._iter().first()  # type: ignore\n    |            ^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2842, in _iter\n    |     result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(\n    |                                                   ^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2262, in execute\n    |     return self._execute_internal(\n    |            ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2134, in _execute_internal\n    |     conn = self._connection_for_bind(bind)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2001, in _connection_for_bind\n    |     return trans._connection_for_bind(engine, execution_options)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "<string>", line 2, in _connection_for_bind\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go\n    |     ret_value = fn(self, *arg, **kw)\n    |                 ^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1126, in _connection_for_bind\n    |     conn = bind.connect()\n    |            ^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3264, in connect\n    |     return self._connection_cls(self)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 147, in __init__\n    |     Connection._handle_dbapi_exception_noconnection(\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2426, in _handle_dbapi_exception_noconnection\n    |     raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 145, in __init__\n    |     self._dbapi_connection = engine.raw_connection()\n    |                              ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3288, in raw_connection\n    |     return self.pool.connect()\n    |            ^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 452, in connect\n    |     return _ConnectionFairy._checkout(self)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 1267, in _checkout\n    |     fairy = _ConnectionRecord.checkout(pool)\n    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 716, in checkout\n    |     rec = pool._do_get()\n    |           ^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get\n    |     with util.safe_reraise():\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__\n    |     raise exc_value.with_traceback(exc_tb)\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 167, in _do_get\n    |     return self._create_connection()\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 393, in _create_connection\n    |     return _ConnectionRecord(self)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 678, in __init__\n    |     self.__connect()\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 902, in __connect\n    |     with util.safe_reraise():\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__\n    |     raise exc_value.with_traceback(exc_tb)\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 898, in __connect\n    |     self.dbapi_connection = connection = pool._invoke_creator(self)\n    |                                          ^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/create.py", line 637, in connect\n    |     return dialect.connect(*cargs, **cparams)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 615, in connect\n    |     return self.loaded_dbapi.connect(*cargs, **cparams)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File "/usr/local/lib/python3.11/site-packages/psycopg2/__init__.py", line 122, in connect\n    |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    | sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: Connection refused\n    | \tIs the server running on that host and accepting TCP/IP connections?\n    | connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused\n    | \tIs the server running on that host and accepting TCP/IP connections?\n    | \n    | (Background on this error at: https://sqlalche.me/e/20/e3q8)\n    +------------------------------------\n'}, 'request': {'method': 'GET', 'url': 'http://localhost:8080/resumos?url=https%3A%2F%2Fwww.wikipedia.org%2Fteste', 'headers': {'host': 'localhost:8080', 'user-agent': 'insomnia/10.0.0', 'correlationid': '12345', 'accept': '*/*'}}}
2024-10-01 02:57:25,308 - app.logging.logging_interceptor - INFO - 
2024-10-01 02:57:55,307 - app.logging.logging_interceptor - INFO - 
2024-10-01 02:58:25,306 - app.logging.logging_interceptor - INFO - 
2024-10-01 02:58:55,315 - app.logging.logging_interceptor - INFO - 
2024-10-01 02:59:25,307 - app.logging.logging_interceptor - INFO - 
2024-10-01 02:59:55,307 - app.logging.logging_interceptor - INFO - 
2024-10-01 03:00:27,181 - app.logging.logging_interceptor - INFO - 
2024-10-01 03:00:40,012 - app.logging.logging_interceptor - INFO - 
2024-10-01 03:01:10,013 - app.logging.logging_interceptor - INFO - 
2024-10-01 03:01:27,796 - app.logging.logging_interceptor - INFO - 
2024-10-01 03:01:33,485 - app.logging.logging_interceptor - INFO - 
2024-10-01 03:01:40,017 - app.logging.logging_interceptor - INFO - 
2024-10-01 03:02:06,842 - app.logging.logging_interceptor - INFO - 
2024-10-01 03:02:10,025 - app.logging.logging_interceptor - INFO - 
2024-10-01 03:02:40,012 - app.logging.logging_interceptor - INFO - 
2024-10-01 03:03:10,007 - app.logging.logging_interceptor - INFO - 
2024-10-01 03:03:40,012 - app.logging.logging_interceptor - INFO - 
2024-10-01 03:03:56,172 - app.logging.logging_interceptor - INFO - 
2024-10-01 03:04:10,009 - app.logging.logging_interceptor - INFO - 
2024-10-01 03:04:40,012 - app.logging.logging_interceptor - INFO - 
2024-10-01 03:05:10,008 - app.logging.logging_interceptor - INFO - 
2024-10-01 03:05:40,014 - app.logging.logging_interceptor - INFO - 
2024-10-01 03:06:10,015 - app.logging.logging_interceptor - INFO - 
2024-10-01 03:06:40,008 - app.logging.logging_interceptor - INFO - 
2024-10-01 03:07:10,010 - app.logging.logging_interceptor - INFO - 
2024-10-01 03:07:40,009 - app.logging.logging_interceptor - INFO - 
2024-10-01 03:08:10,011 - app.logging.logging_interceptor - INFO - 
2024-10-01 03:08:40,011 - app.logging.logging_interceptor - INFO - 
2024-10-01 03:09:10,009 - app.logging.logging_interceptor - INFO - 
2024-10-01 03:09:40,008 - app.logging.logging_interceptor - INFO - 
2024-10-01 03:10:10,015 - app.logging.logging_interceptor - INFO - 
2024-10-01 03:10:40,020 - app.logging.logging_interceptor - INFO - 
2024-10-01 03:11:10,013 - app.logging.logging_interceptor - INFO - 
2024-10-01 03:11:40,015 - app.logging.logging_interceptor - INFO - 
2024-10-01 03:12:10,015 - app.logging.logging_interceptor - INFO - 
2024-10-01 03:12:40,010 - app.logging.logging_interceptor - INFO - 
2024-10-01 03:13:10,017 - app.logging.logging_interceptor - INFO - 
2024-10-01 03:13:40,006 - app.logging.logging_interceptor - INFO - 
2024-10-01 03:14:10,011 - app.logging.logging_interceptor - INFO - 
2024-10-01 03:14:40,007 - app.logging.logging_interceptor - INFO - 
2024-10-01 03:15:10,015 - app.logging.logging_interceptor - INFO - 
2024-10-01 03:15:40,012 - app.logging.logging_interceptor - INFO - 
2024-10-01 03:16:10,004 - app.logging.logging_interceptor - INFO - 
2024-10-01 03:16:40,009 - app.logging.logging_interceptor - INFO - 
2024-10-01 03:17:10,008 - app.logging.logging_interceptor - INFO - 
2024-10-01 03:17:40,022 - app.logging.logging_interceptor - INFO - 
2024-10-01 03:18:10,009 - app.logging.logging_interceptor - INFO - 
2024-10-01 03:18:40,008 - app.logging.logging_interceptor - INFO - 
2024-10-01 03:19:10,015 - app.logging.logging_interceptor - INFO - 
2024-10-01 03:19:40,004 - app.logging.logging_interceptor - INFO - 
2024-10-01 03:20:10,011 - app.logging.logging_interceptor - INFO - 
2024-10-01 03:20:40,008 - app.logging.logging_interceptor - INFO - 
2024-10-01 03:21:10,010 - app.logging.logging_interceptor - INFO - 
2024-10-01 03:21:40,006 - app.logging.logging_interceptor - INFO - 
2024-10-01 03:22:10,015 - app.logging.logging_interceptor - INFO - 
2024-10-01 03:22:40,013 - app.logging.logging_interceptor - INFO - 
2024-10-01 03:23:10,006 - app.logging.logging_interceptor - INFO - 
2024-10-01 03:23:40,013 - app.logging.logging_interceptor - INFO - 
2024-10-01 03:24:10,011 - app.logging.logging_interceptor - INFO - 
2024-10-01 03:24:40,013 - app.logging.logging_interceptor - INFO - 
2024-10-01 03:25:10,010 - app.logging.logging_interceptor - INFO - 
2024-10-01 03:25:40,014 - app.logging.logging_interceptor - INFO - 
2024-10-01 03:26:10,010 - app.logging.logging_interceptor - INFO - 
2024-10-01 03:26:40,004 - app.logging.logging_interceptor - INFO - 
2024-10-01 03:27:10,010 - app.logging.logging_interceptor - INFO - 
2024-10-01 03:27:40,014 - app.logging.logging_interceptor - INFO - 
2024-10-01 03:28:10,012 - app.logging.logging_interceptor - INFO - 
2024-10-01 03:28:40,008 - app.logging.logging_interceptor - INFO - 
2024-10-01 03:29:10,014 - app.logging.logging_interceptor - INFO - 
2024-10-01 03:29:40,011 - app.logging.logging_interceptor - INFO - 
2024-10-01 03:30:10,013 - app.logging.logging_interceptor - INFO - 
2024-10-01 03:30:40,012 - app.logging.logging_interceptor - INFO - 
